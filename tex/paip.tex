% -*- ess-noweb-default-code-mode: lisp-mode; -*-% ===> this file was generated automatically by noweave --- better not edit it
\documentclass{tufte-book}
\usepackage{noweb}

\usepackage{color}
% https://commons.wikimedia.org/wiki/File:Erlang_logo.svg
\definecolor{ErlangRed}{HTML}{A90533}

\usepackage{hyperref}
\hypersetup{
  bookmarks=true,
  pdffitwindow=true,
  pdfstartview={FitH},
  pdftitle={PAIP Exercises},
  pdfauthor={Eric Bailey <eric@ericb.me>},
  pdfsubject={Paradigms of Artificial Intelligence Programming},
  pdfkeywords={Lisp, artificial intelligence, literate programming, noweb},
  colorlinks=true,
  linkcolor=ErlangRed,
  urlcolor=ErlangRed
}

\usepackage{amsmath}
\usepackage{amssymb}

\usepackage[outputdir=tex]{minted}

% NOTE: Use Tufte instead of noweb page style.
% \pagestyle{noweb}
% NOTE: Use shift option for wide code.
\noweboptions{smallcode,shortxref,webnumbering,english}

\title{PAIP Exercises}

\author{Eric Bailey}

% \date{January 23, 2017}

\newcommand{\stylehook}{\marginpar{\raggedright\sl Style hook}}

\newmintinline[lsp]{lisp}{}

\begin{document}
\maketitle
\nwfilename{paip.nw}\nwbegindocs{1}\nwdocspar

\tableofcontents
\newpage

\chapter{Introduction to Common Lisp}

\section{Using Functions}

\nwenddocs{}\nwbegincode{2}\sublabel{NWlJ9ZL-BpWdi-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-BpWdi-1}}}\moddef{titles~{\nwtagstyle{}\subpageref{NWlJ9ZL-BpWdi-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3M2WD4-1}}\nwenddeflinemarkup
(defparameter \nwlinkedidentc{*titles*}{NWlJ9ZL-BpWdi-1}
  '(Mr Mrs Miss Ms Sir Madam Dr Admiral Major General)
  "A list of titles that can appear at the start of a name.")
\nwindexdefn{\nwixident{*titles*}}{*titles*}{NWlJ9ZL-BpWdi-1}\eatline
\nwused{\\{NWlJ9ZL-3M2WD4-1}}\nwidentdefs{\\{{\nwixident{*titles*}}{*titles*}}}\nwendcode{}\nwbegindocs{3}\nwdocspar
\nwenddocs{}\nwbegincode{4}\sublabel{NWlJ9ZL-1xnn0Z-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1xnn0Z-1}}}\moddef{abstract first-name~{\nwtagstyle{}\subpageref{NWlJ9ZL-1xnn0Z-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(\LA{}function first-name(name):~{\nwtagstyle{}\subpageref{NWlJ9ZL-4ONS4K-1}}\RA{}
  (\LA{}if the first element of name is a title~{\nwtagstyle{}\subpageref{NWlJ9ZL-Ix42V-1}}\RA{}
    \LA{}then return the first-name of the rest of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-2nVNHx-1}}\RA{}
    \LA{}else return the first element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-16R8JG-1}}\RA{}))
\nwnotused{abstract first-name}\nwendcode{}\nwbegindocs{5}\nwdocspar

\nwenddocs{}\nwbegincode{6}\sublabel{NWlJ9ZL-4ONS4K-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4ONS4K-1}}}\moddef{function first-name(name):~{\nwtagstyle{}\subpageref{NWlJ9ZL-4ONS4K-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-1xnn0Z-1}}\nwenddeflinemarkup
defun first-name (name)
 "Select the first name from a name represented as a list."
\nwused{\\{NWlJ9ZL-1xnn0Z-1}}\nwendcode{}\nwbegindocs{7}\nwdocspar

\nwenddocs{}\nwbegincode{8}\sublabel{NWlJ9ZL-Ix42V-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-Ix42V-1}}}\moddef{if the first element of name is a title~{\nwtagstyle{}\subpageref{NWlJ9ZL-Ix42V-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-1xnn0Z-1}}\nwenddeflinemarkup
if (member (first name) \nwlinkedidentc{*titles*}{NWlJ9ZL-BpWdi-1})
\nwused{\\{NWlJ9ZL-1xnn0Z-1}}\nwidentuses{\\{{\nwixident{*titles*}}{*titles*}}}\nwindexuse{\nwixident{*titles*}}{*titles*}{NWlJ9ZL-Ix42V-1}\nwendcode{}\nwbegindocs{9}\nwdocspar

\nwenddocs{}\nwbegincode{10}\sublabel{NWlJ9ZL-2nVNHx-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2nVNHx-1}}}\moddef{then return the first-name of the rest of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-2nVNHx-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-1xnn0Z-1}}\nwenddeflinemarkup
  (first-name (rest name))
\nwused{\\{NWlJ9ZL-1xnn0Z-1}}\nwendcode{}\nwbegindocs{11}\nwdocspar

\nwenddocs{}\nwbegincode{12}\sublabel{NWlJ9ZL-16R8JG-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-16R8JG-1}}}\moddef{else return the first element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-16R8JG-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-1xnn0Z-1}}\nwenddeflinemarkup
(first name)
\nwused{\\{NWlJ9ZL-1xnn0Z-1}}\nwendcode{}\nwbegindocs{13}\nwdocspar

\section{Exercises}

\nwenddocs{}\nwbegincode{14}\sublabel{NWlJ9ZL-3M2WD4-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3M2WD4-1}}}\moddef{src/intro.lisp~{\nwtagstyle{}\subpageref{NWlJ9ZL-3M2WD4-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(in-package #:paip)
(defpackage #:paip.intro
  (:\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} #:cl #:lisp-unit))
(in-package #:paip.intro)

\LA{}titles~{\nwtagstyle{}\subpageref{NWlJ9ZL-BpWdi-1}}\RA{}

;; Exercise 1.1
\LA{}Exercise 1.1~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Wuo2N-1}}\RA{}

;; Exercise 1.2
\LA{}Exercise 1.2~{\nwtagstyle{}\subpageref{NWlJ9ZL-2DHmDj-1}}\RA{}

;; Exercise 1.3
\LA{}Exercise 1.3~{\nwtagstyle{}\subpageref{NWlJ9ZL-2b8599-1}}\RA{}
\nwnotused{src/intro.lisp}\nwidentuses{\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-3M2WD4-1}\nwendcode{}\nwbegindocs{15}\nwdocspar

\subsection{Exercise 1.1}

\begin{quote}
  Define a version of {\Tt{}\nwlinkedidentq{last-name}{NWlJ9ZL-4Zlwoj-1}\nwendquote} that handles ``Rex Morgan MD,'' ``Morton
  Downey, Jr.,'' and whatever other cases you can think of.
\end{quote}

\nwenddocs{}\nwbegincode{16}\sublabel{NWlJ9ZL-4Wuo2N-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4Wuo2N-1}}}\moddef{Exercise 1.1~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Wuo2N-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3M2WD4-1}}\nwenddeflinemarkup
\LA{}suffixes~{\nwtagstyle{}\subpageref{NWlJ9ZL-33GIZY-1}}\RA{}

\LA{}last-name~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zlwoj-1}}\RA{}

\LA{}Exercise 1.1 tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-29KvuZ-1}}\RA{}
\nwused{\\{NWlJ9ZL-3M2WD4-1}}\nwendcode{}\nwbegindocs{17}\nwdocspar

\nwenddocs{}\nwbegincode{18}\sublabel{NWlJ9ZL-4Zlwoj-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zlwoj-1}}}\moddef{last-name~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zlwoj-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Wuo2N-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{last-name}{NWlJ9ZL-4Zlwoj-1} (name)\nwindexdefn{\nwixident{last-name}}{last-name}{NWlJ9ZL-4Zlwoj-1}
  "Select the last name from a name represented as a list."
  (if \LA{}the last element of a name is a suffix~{\nwtagstyle{}\subpageref{NWlJ9ZL-2t3lxE-1}}\RA{}
      \LA{}then return the \code{}last-name\edoc{} of all but the last element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-3W6gHs-1}}\RA{}
    \LA{}else return the last element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-2NIVBh-1}}\RA{}))
\nwused{\\{NWlJ9ZL-4Wuo2N-1}}\nwidentdefs{\\{{\nwixident{last-name}}{last-name}}}\nwendcode{}\nwbegindocs{19}\nwdocspar

First, we check to see if the last element of the \lsp{name} is a suffix, i.e.
whether it's a member of {\Tt{}\nwlinkedidentq{*suffixes*}{NWlJ9ZL-33GIZY-1}\nwendquote}.
\nwenddocs{}\nwbegincode{20}\sublabel{NWlJ9ZL-2t3lxE-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2t3lxE-1}}}\moddef{the last element of a name is a suffix~{\nwtagstyle{}\subpageref{NWlJ9ZL-2t3lxE-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Zlwoj-1}}\nwenddeflinemarkup
(member (first (last name)) \nwlinkedidentc{*suffixes*}{NWlJ9ZL-33GIZY-1})
\nwused{\\{NWlJ9ZL-4Zlwoj-1}}\nwidentuses{\\{{\nwixident{*suffixes*}}{*suffixes*}}}\nwindexuse{\nwixident{*suffixes*}}{*suffixes*}{NWlJ9ZL-2t3lxE-1}\nwendcode{}\nwbegindocs{21}\nwdocspar

If it is, then drop it from the \lsp{name} and return the {\Tt{}\nwlinkedidentq{last-name}{NWlJ9ZL-4Zlwoj-1}\nwendquote} of the
result.
\nwenddocs{}\nwbegincode{22}\sublabel{NWlJ9ZL-3W6gHs-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3W6gHs-1}}}\moddef{then return the \code{}last-name\edoc{} of all but the last element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-3W6gHs-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Zlwoj-1}}\nwenddeflinemarkup
(\nwlinkedidentc{last-name}{NWlJ9ZL-4Zlwoj-1} (butlast name))
\nwused{\\{NWlJ9ZL-4Zlwoj-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NWlJ9ZL-3W6gHs-1}\nwendcode{}\nwbegindocs{23}\nwdocspar

Otherwise, it's the last name, so return it.
\nwenddocs{}\nwbegincode{24}\sublabel{NWlJ9ZL-2NIVBh-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2NIVBh-1}}}\moddef{else return the last element of the name~{\nwtagstyle{}\subpageref{NWlJ9ZL-2NIVBh-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Zlwoj-1}}\nwenddeflinemarkup
(first (last name))
\nwused{\\{NWlJ9ZL-4Zlwoj-1}}\nwendcode{}\nwbegindocs{25}\nwdocspar

\nwenddocs{}\nwbegincode{26}\sublabel{NWlJ9ZL-33GIZY-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-33GIZY-1}}}\moddef{suffixes~{\nwtagstyle{}\subpageref{NWlJ9ZL-33GIZY-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Wuo2N-1}}\nwenddeflinemarkup
(defparameter \nwlinkedidentc{*suffixes*}{NWlJ9ZL-33GIZY-1}
  '(MD Jr)
  "A list of suffixes that can appear at the end of a name.")
\nwindexdefn{\nwixident{*suffixes*}}{*suffixes*}{NWlJ9ZL-33GIZY-1}\eatline
\nwused{\\{NWlJ9ZL-4Wuo2N-1}}\nwidentdefs{\\{{\nwixident{*suffixes*}}{*suffixes*}}}\nwendcode{}\nwbegindocs{27}\nwdocspar
\nwenddocs{}\nwbegincode{28}\sublabel{NWlJ9ZL-29KvuZ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-29KvuZ-1}}}\moddef{Exercise 1.1 tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-29KvuZ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Wuo2N-1}}\nwenddeflinemarkup
(define-test test-last-name
  \LA{}Rex Morgan MD~{\nwtagstyle{}\subpageref{NWlJ9ZL-1iWMbJ-1}}\RA{}
  \LA{}Morton Downey, Jr~{\nwtagstyle{}\subpageref{NWlJ9ZL-189ElO-1}}\RA{})
\nwused{\\{NWlJ9ZL-4Wuo2N-1}}\nwendcode{}\nwbegindocs{29}\nwdocspar

\marginnote[\baselineskip]{
  Assert that the {\Tt{}\nwlinkedidentq{last-name}{NWlJ9ZL-4Zlwoj-1}\nwendquote} of {\sl Rex Morgan MD} is {\sl Morgan}.
}
\nwenddocs{}\nwbegincode{30}\sublabel{NWlJ9ZL-1iWMbJ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1iWMbJ-1}}}\moddef{Rex Morgan MD~{\nwtagstyle{}\subpageref{NWlJ9ZL-1iWMbJ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-29KvuZ-1}}\nwenddeflinemarkup
(assert-equal 'Morgan (\nwlinkedidentc{last-name}{NWlJ9ZL-4Zlwoj-1} '(Rex Morgan MD)))
\nwused{\\{NWlJ9ZL-29KvuZ-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NWlJ9ZL-1iWMbJ-1}\nwendcode{}\nwbegindocs{31}\nwdocspar

\nwenddocs{}\nwbegincode{32}\sublabel{NWlJ9ZL-189ElO-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-189ElO-1}}}\moddef{Morton Downey, Jr~{\nwtagstyle{}\subpageref{NWlJ9ZL-189ElO-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-29KvuZ-1}}\nwenddeflinemarkup
(assert-equal 'Downey (\nwlinkedidentc{last-name}{NWlJ9ZL-4Zlwoj-1} '(Morton Downey Jr)))
\nwused{\\{NWlJ9ZL-29KvuZ-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NWlJ9ZL-189ElO-1}\nwendcode{}\nwbegindocs{33}\nwdocspar

\subsection{Exercise 1.2}

\begin{quote}
  Write a function to exponentiate, or raise a number to an integer power. For
  example \lsp{(}{\Tt{}\nwlinkedidentq{power}{NWlJ9ZL-3kZCB2-1}\nwendquote}\lsp{ 3 2)} $= 3^2 = 9$.
\end{quote}

\nwenddocs{}\nwbegincode{34}\sublabel{NWlJ9ZL-2DHmDj-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2DHmDj-1}}}\moddef{Exercise 1.2~{\nwtagstyle{}\subpageref{NWlJ9ZL-2DHmDj-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3M2WD4-1}}\nwenddeflinemarkup
\LA{}square~{\nwtagstyle{}\subpageref{NWlJ9ZL-3NPSQP-1}}\RA{}

\LA{}power~{\nwtagstyle{}\subpageref{NWlJ9ZL-3kZCB2-1}}\RA{}

\LA{}Exercise 1.2 tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-Nfd08-1}}\RA{}
\nwused{\\{NWlJ9ZL-3M2WD4-1}}\nwendcode{}\nwbegindocs{35}\nwdocspar

\marginnote[2.5\baselineskip]{
  \begin{align*}
    x^n = \begin{cases}
      1 & \text{if } n = 0, \\
      (x^{n / 2})^2 & \text{if } n \text{ is even}, \\
      x \times x^{n - 1} & \text{otherwise}.
    \end{cases}
  \end{align*}
}
\nwenddocs{}\nwbegincode{36}\sublabel{NWlJ9ZL-3kZCB2-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3kZCB2-1}}}\moddef{power~{\nwtagstyle{}\subpageref{NWlJ9ZL-3kZCB2-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2DHmDj-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{power}{NWlJ9ZL-3kZCB2-1} (x n)\nwindexdefn{\nwixident{power}}{power}{NWlJ9ZL-3kZCB2-1}
  "Raise x to the \nwlinkedidentc{power}{NWlJ9ZL-3kZCB2-1} of n."
  (cond \LA{}if n is zero return 1~{\nwtagstyle{}\subpageref{NWlJ9ZL-2y88rI-1}}\RA{}
        \LA{}if n is even return x to the power of n over two, squared~{\nwtagstyle{}\subpageref{NWlJ9ZL-3Slm34-1}}\RA{}
        \LA{}otherwise return x times x to the power of n minus one~{\nwtagstyle{}\subpageref{NWlJ9ZL-1kE0RF-1}}\RA{}))
\nwused{\\{NWlJ9ZL-2DHmDj-1}}\nwidentdefs{\\{{\nwixident{power}}{power}}}\nwendcode{}\nwbegindocs{37}\nwdocspar

\marginnote[\baselineskip]{$x^0 = 1$}
\nwenddocs{}\nwbegincode{38}\sublabel{NWlJ9ZL-2y88rI-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2y88rI-1}}}\moddef{if n is zero return 1~{\nwtagstyle{}\subpageref{NWlJ9ZL-2y88rI-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3kZCB2-1}}\nwenddeflinemarkup
((zerop n) 1)
\nwused{\\{NWlJ9ZL-3kZCB2-1}}\nwendcode{}\nwbegindocs{39}\nwdocspar

\nwenddocs{}\nwbegincode{40}\sublabel{NWlJ9ZL-3Slm34-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3Slm34-1}}}\moddef{if n is even return x to the power of n over two, squared~{\nwtagstyle{}\subpageref{NWlJ9ZL-3Slm34-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3kZCB2-1}}\nwenddeflinemarkup
((evenp n) (\nwlinkedidentc{square}{NWlJ9ZL-3NPSQP-1} (\nwlinkedidentc{power}{NWlJ9ZL-3kZCB2-1} x (/ n 2))))
\nwused{\\{NWlJ9ZL-3kZCB2-1}}\nwidentuses{\\{{\nwixident{power}}{power}}\\{{\nwixident{square}}{square}}}\nwindexuse{\nwixident{power}}{power}{NWlJ9ZL-3Slm34-1}\nwindexuse{\nwixident{square}}{square}{NWlJ9ZL-3Slm34-1}\nwendcode{}\nwbegindocs{41}\nwdocspar

\nwenddocs{}\nwbegincode{42}\sublabel{NWlJ9ZL-1kE0RF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1kE0RF-1}}}\moddef{otherwise return x times x to the power of n minus one~{\nwtagstyle{}\subpageref{NWlJ9ZL-1kE0RF-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3kZCB2-1}}\nwenddeflinemarkup
(t (* x (\nwlinkedidentc{power}{NWlJ9ZL-3kZCB2-1} x (- n 1))))
\nwused{\\{NWlJ9ZL-3kZCB2-1}}\nwidentuses{\\{{\nwixident{power}}{power}}}\nwindexuse{\nwixident{power}}{power}{NWlJ9ZL-1kE0RF-1}\nwendcode{}\nwbegindocs{43}\nwdocspar

\marginnote[\baselineskip]{$\text{square}(x) = x^2$}
\nwenddocs{}\nwbegincode{44}\sublabel{NWlJ9ZL-3NPSQP-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3NPSQP-1}}}\moddef{square~{\nwtagstyle{}\subpageref{NWlJ9ZL-3NPSQP-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2DHmDj-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{square}{NWlJ9ZL-3NPSQP-1} (x) (expt x 2))\nwindexdefn{\nwixident{square}}{square}{NWlJ9ZL-3NPSQP-1}
\nwused{\\{NWlJ9ZL-2DHmDj-1}}\nwidentdefs{\\{{\nwixident{square}}{square}}}\nwendcode{}\nwbegindocs{45}\nwdocspar

\nwenddocs{}\nwbegincode{46}\sublabel{NWlJ9ZL-Nfd08-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-Nfd08-1}}}\moddef{Exercise 1.2 tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-Nfd08-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2DHmDj-1}}\nwenddeflinemarkup
(define-test test-power
  (assert-equal 9 (\nwlinkedidentc{power}{NWlJ9ZL-3kZCB2-1} 3 2)))
\nwused{\\{NWlJ9ZL-2DHmDj-1}}\nwidentuses{\\{{\nwixident{power}}{power}}}\nwindexuse{\nwixident{power}}{power}{NWlJ9ZL-Nfd08-1}\nwendcode{}\nwbegindocs{47}\nwdocspar

\subsection{Exercise 1.3}

\begin{quote}
  Write a function that counts the number of atoms in an expression. For
  example: \lsp{(}{\Tt{}\nwlinkedidentq{count-atoms}{NWlJ9ZL-2b8599-1}\nwendquote}\lsp{ '(a (b) c))} $= 3$. Notice that there is
  something of an ambiguity in this: should \lsp{(a nil c)} count as three
  atoms, or as two, because it is equivalent to \lsp{(a () c)}?
\end{quote}

\nwenddocs{}\nwbegincode{48}\sublabel{NWlJ9ZL-2b8599-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2b8599-1}}}\moddef{Exercise 1.3~{\nwtagstyle{}\subpageref{NWlJ9ZL-2b8599-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3M2WD4-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{count-atoms}{NWlJ9ZL-2b8599-1} (exp)\nwindexdefn{\nwixident{count-atoms}}{count-atoms}{NWlJ9ZL-2b8599-1}
  "Return the total number of non-nil atoms in the expression."
  (cond \LA{}if exp is nil there are no atoms~{\nwtagstyle{}\subpageref{NWlJ9ZL-2dHnrc-1}}\RA{}
        \LA{}if exp is an atom there is only one~{\nwtagstyle{}\subpageref{NWlJ9ZL-20ij8Y-1}}\RA{}
        \LA{}otherwise add the count of the atoms in the first and rest of exp~{\nwtagstyle{}\subpageref{NWlJ9ZL-44AOMF-1}}\RA{}))
\nwused{\\{NWlJ9ZL-3M2WD4-1}}\nwidentdefs{\\{{\nwixident{count-atoms}}{count-atoms}}}\nwendcode{}\nwbegindocs{49}\nwdocspar

\nwenddocs{}\nwbegincode{50}\sublabel{NWlJ9ZL-2dHnrc-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2dHnrc-1}}}\moddef{if exp is nil there are no atoms~{\nwtagstyle{}\subpageref{NWlJ9ZL-2dHnrc-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2b8599-1}}\nwenddeflinemarkup
((null exp) 0)
\nwused{\\{NWlJ9ZL-2b8599-1}}\nwendcode{}\nwbegindocs{51}\nwdocspar

\nwenddocs{}\nwbegincode{52}\sublabel{NWlJ9ZL-20ij8Y-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-20ij8Y-1}}}\moddef{if exp is an atom there is only one~{\nwtagstyle{}\subpageref{NWlJ9ZL-20ij8Y-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2b8599-1}}\nwenddeflinemarkup
((atom exp) 1)
\nwused{\\{NWlJ9ZL-2b8599-1}}\nwendcode{}\nwbegindocs{53}\nwdocspar

\nwenddocs{}\nwbegincode{54}\sublabel{NWlJ9ZL-44AOMF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-44AOMF-1}}}\moddef{otherwise add the count of the atoms in the first and rest of exp~{\nwtagstyle{}\subpageref{NWlJ9ZL-44AOMF-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-2b8599-1}}\nwenddeflinemarkup
(t (+ (\nwlinkedidentc{count-atoms}{NWlJ9ZL-2b8599-1} (first exp))
      (\nwlinkedidentc{count-atoms}{NWlJ9ZL-2b8599-1} (rest exp))))
\nwused{\\{NWlJ9ZL-2b8599-1}}\nwidentuses{\\{{\nwixident{count-atoms}}{count-atoms}}}\nwindexuse{\nwixident{count-atoms}}{count-atoms}{NWlJ9ZL-44AOMF-1}\nwendcode{}\nwbegindocs{55}\nwdocspar

\section{Higher-Order Functions}

\nwenddocs{}\nwbegincode{56}\sublabel{NWlJ9ZL-4BOcTg-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4BOcTg-1}}}\moddef{mappend~{\nwtagstyle{}\subpageref{NWlJ9ZL-4BOcTg-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{mappend}{NWlJ9ZL-4BOcTg-1} (fn the-list)\nwindexdefn{\nwixident{mappend}}{mappend}{NWlJ9ZL-4BOcTg-1}
  "Apply fn to each element of list and append the results."
  (apply #'append (mapcar fn the-list)))
\nwused{\\{NWlJ9ZL-wDl5T-1}\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{mappend}}{mappend}}}\nwendcode{}\nwbegindocs{57}\nwdocspar

\chapter{A Simple Lisp Program}

\nwenddocs{}\nwbegincode{58}\sublabel{NWlJ9ZL-2bmzlG-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2bmzlG-1}}}\moddef{random-elt~{\nwtagstyle{}\subpageref{NWlJ9ZL-2bmzlG-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{random-elt}{NWlJ9ZL-2bmzlG-1} (choices)\nwindexdefn{\nwixident{random-elt}}{random-elt}{NWlJ9ZL-2bmzlG-1}
  "Choose an element from a list at random."
  (elt choices (random (length choices))))
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{random-elt}}{random-elt}}}\nwendcode{}\nwbegindocs{59}\nwdocspar

\chapter{Overview of Lisp}

\nwenddocs{}\nwbegincode{60}\sublabel{NWlJ9ZL-3sUrxR-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3sUrxR-1}}}\moddef{find-all~{\nwtagstyle{}\subpageref{NWlJ9ZL-3sUrxR-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{find-all}{NWlJ9ZL-3sUrxR-1} (item sequence &rest keyword-args\nwindexdefn{\nwixident{find-all}}{find-all}{NWlJ9ZL-3sUrxR-1}
                 &key (test #'eql) test-not &allow-other-keys)
  "Find all those elements of sequence that match item,
  according to the keywords. Doesn't alter sequence."
  (if test-not
      (apply #'remove item sequence
             :test-not (complement test-not) keyword-args)
      (apply #'remove item sequence
             :test (complement test) keyword-args)))

;; (setf (symbol-function 'find-all-if) #'remove-if-not)
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{find-all}}{find-all}}}\nwendcode{}\nwbegindocs{61}\nwdocspar

\chapter{GPS: The General Problem Solver}

\nwenddocs{}\nwbegincode{62}\sublabel{NWlJ9ZL-wDl5T-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-wDl5T-1}}}\moddef{src/gps.lisp~{\nwtagstyle{}\subpageref{NWlJ9ZL-wDl5T-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(in-package #:paip)
(defpackage #:paip.gps
  (:\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} #:cl #:lisp-unit)
  (:shadow #:\nwlinkedidentc{debug}{NWlJ9ZL-3LP9Za-1})
  (:export #:\nwlinkedidentc{GPS}{NWlJ9ZL-30p2tX-1}))
(in-package #:paip.gps)

\LA{}find-all~{\nwtagstyle{}\subpageref{NWlJ9ZL-3sUrxR-1}}\RA{}

\LA{}mappend~{\nwtagstyle{}\subpageref{NWlJ9ZL-4BOcTg-1}}\RA{}

\LA{}A list of available operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-1JBQVW-1}}\RA{}

\LA{}An operation with preconds, add-list and del-list~{\nwtagstyle{}\subpageref{NWlJ9ZL-2hGwYk-1}}\RA{}

\LA{}Solve a goal from a state using a list of operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-30p2tX-1}}\RA{}

\LA{}Achieve an individual goal~{\nwtagstyle{}\subpageref{NWlJ9ZL-1Tx3Kh-1}}\RA{}

\LA{}Achieve all goals~{\nwtagstyle{}\subpageref{NWlJ9ZL-23MH3b-1}}\RA{}

\LA{}Decide if an operator is appropriate for a goal~{\nwtagstyle{}\subpageref{NWlJ9ZL-ocPeo-1}}\RA{}

\LA{}Apply operator to current state~{\nwtagstyle{}\subpageref{NWlJ9ZL-3nt6zV-1}}\RA{}

\LA{}Auxiliary Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-QzWjb-1}}\RA{}

\LA{}Nursery School Example~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zg5N4-1}}\RA{}

\LA{}Monkey and Bananas Example~{\nwtagstyle{}\subpageref{NWlJ9ZL-GNLBM-1}}\RA{}

\LA{}The Maze Searching Domain~{\nwtagstyle{}\subpageref{NWlJ9ZL-2DSCmQ-1}}\RA{}

\LA{}Maze Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-v1OUw-1}}\RA{}

\LA{}Convert existing operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-yooUt-1}}\RA{}

\LA{}The Blocks World Domain~{\nwtagstyle{}\subpageref{NWlJ9ZL-1t2bMc-1}}\RA{}

\LA{}Print debugging information~{\nwtagstyle{}\subpageref{NWlJ9ZL-3LP9Za-1}}\RA{}

\LA{}GPS Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-1ahSlC-1}}\RA{}
\nwnotused{src/gps.lisp}\nwidentuses{\\{{\nwixident{debug}}{debug}}\\{{\nwixident{GPS}}{GPS}}\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{debug}}{debug}{NWlJ9ZL-wDl5T-1}\nwindexuse{\nwixident{GPS}}{GPS}{NWlJ9ZL-wDl5T-1}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-wDl5T-1}\nwendcode{}\nwbegindocs{63}\nwdocspar

\nwenddocs{}\nwbegincode{64}\sublabel{NWlJ9ZL-1JBQVW-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1JBQVW-1}}}\moddef{A list of available operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-1JBQVW-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defvar \nwlinkedidentc{*ops*}{NWlJ9ZL-1JBQVW-1} nil "A list of available operators.")\nwindexdefn{\nwixident{*ops*}}{*ops*}{NWlJ9ZL-1JBQVW-1}
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{*ops*}}{*ops*}}}\nwendcode{}\nwbegindocs{65}\nwdocspar

\nwenddocs{}\nwbegincode{66}\sublabel{NWlJ9ZL-2hGwYk-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2hGwYk-1}}}\moddef{An operation with preconds, add-list and del-list~{\nwtagstyle{}\subpageref{NWlJ9ZL-2hGwYk-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defstruct \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}
  "An operation"
  (action nil)
  (preconds nil)
  (add-list nil)
  (del-list nil))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentuses{\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-2hGwYk-1}\nwendcode{}\nwbegindocs{67}\nwdocspar

\nwenddocs{}\nwbegincode{68}\sublabel{NWlJ9ZL-30p2tX-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-30p2tX-1}}}\moddef{Solve a goal from a state using a list of operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-30p2tX-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{GPS}{NWlJ9ZL-30p2tX-1} (state goals &optional (\nwlinkedidentc{*ops*}{NWlJ9ZL-1JBQVW-1} \nwlinkedidentc{*ops*}{NWlJ9ZL-1JBQVW-1}))\nwindexdefn{\nwixident{GPS}}{GPS}{NWlJ9ZL-30p2tX-1}
  "General Problem Solver: from state, \nwlinkedidentc{achieve}{NWlJ9ZL-1Tx3Kh-1} goals using *ops*."
  (remove-if-not #'\nwlinkedidentc{action-p}{NWlJ9ZL-lDJbR-1}
                 (\nwlinkedidentc{achieve-all}{NWlJ9ZL-23MH3b-1} (cons '(start) state) goals nil)))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{GPS}}{GPS}}}\nwidentuses{\\{{\nwixident{*ops*}}{*ops*}}\\{{\nwixident{achieve}}{achieve}}\\{{\nwixident{achieve-all}}{achieve-all}}\\{{\nwixident{action-p}}{action-p}}}\nwindexuse{\nwixident{*ops*}}{*ops*}{NWlJ9ZL-30p2tX-1}\nwindexuse{\nwixident{achieve}}{achieve}{NWlJ9ZL-30p2tX-1}\nwindexuse{\nwixident{achieve-all}}{achieve-all}{NWlJ9ZL-30p2tX-1}\nwindexuse{\nwixident{action-p}}{action-p}{NWlJ9ZL-30p2tX-1}\nwendcode{}\nwbegindocs{69}\nwdocspar

\nwenddocs{}\nwbegincode{70}\sublabel{NWlJ9ZL-23MH3b-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-23MH3b-1}}}\moddef{Achieve all goals~{\nwtagstyle{}\subpageref{NWlJ9ZL-23MH3b-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{achieve-all}{NWlJ9ZL-23MH3b-1} (state goals goal-stack)\nwindexdefn{\nwixident{achieve-all}}{achieve-all}{NWlJ9ZL-23MH3b-1}
  "Achieve each goal, trying several orderings."
  (some #'(lambda (goals) (\nwlinkedidentc{achieve-each}{NWlJ9ZL-23MH3b-1} state goals goal-stack))
        (\nwlinkedidentc{orderings}{NWlJ9ZL-23MH3b-1} goals)))

(defun \nwlinkedidentc{achieve-each}{NWlJ9ZL-23MH3b-1} (state goals goal-stack)\nwindexdefn{\nwixident{achieve-each}}{achieve-each}{NWlJ9ZL-23MH3b-1}
  "Try to \nwlinkedidentc{achieve}{NWlJ9ZL-1Tx3Kh-1} each goal, then make sure they still hold."
  (let ((current-state state))
    (if (and (every #'(lambda (g)
                        (setf current-state
                              (\nwlinkedidentc{achieve}{NWlJ9ZL-1Tx3Kh-1} current-state g goal-stack)))
                    goals)
             (subsetp goals current-state :test #'equal))
        current-state)))

(defun \nwlinkedidentc{orderings}{NWlJ9ZL-23MH3b-1} (lst)\nwindexdefn{\nwixident{orderings}}{orderings}{NWlJ9ZL-23MH3b-1}
  (if (> (length lst) 1)
      (list lst (reverse lst))
      (list lst)))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{achieve-all}}{achieve-all}}\\{{\nwixident{achieve-each}}{achieve-each}}\\{{\nwixident{orderings}}{orderings}}}\nwidentuses{\\{{\nwixident{achieve}}{achieve}}}\nwindexuse{\nwixident{achieve}}{achieve}{NWlJ9ZL-23MH3b-1}\nwendcode{}\nwbegindocs{71}\nwdocspar

\nwenddocs{}\nwbegincode{72}\sublabel{NWlJ9ZL-1Tx3Kh-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1Tx3Kh-1}}}\moddef{Achieve an individual goal~{\nwtagstyle{}\subpageref{NWlJ9ZL-1Tx3Kh-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{achieve}{NWlJ9ZL-1Tx3Kh-1} (state goal goal-stack)\nwindexdefn{\nwixident{achieve}}{achieve}{NWlJ9ZL-1Tx3Kh-1}
  "A goal is achieved if it already holds,
  or if there is an appropriate \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} for it that is applicable."
  (\nwlinkedidentc{dbg-indent}{NWlJ9ZL-3LP9Za-1} :gps (length goal-stack) "Goal: ~a" goal)
  (cond ((\nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} goal state)      state)
        ((\nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} goal goal-stack) nil)
        (t (some #'(lambda (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}) (\nwlinkedidentc{apply-op}{NWlJ9ZL-3nt6zV-1} state goal \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} goal-stack))
                 (\nwlinkedidentc{appropriate-ops}{NWlJ9ZL-1Tx3Kh-1} goal state)))))

(defun \nwlinkedidentc{appropriate-ops}{NWlJ9ZL-1Tx3Kh-1} (goal state)\nwindexdefn{\nwixident{appropriate-ops}}{appropriate-ops}{NWlJ9ZL-1Tx3Kh-1}
  "Return a list of appropriate operators,
  sorted by the number of unfulfilled preconditions."
  (sort (copy-list (\nwlinkedidentc{find-all}{NWlJ9ZL-3sUrxR-1} goal \nwlinkedidentc{*ops*}{NWlJ9ZL-1JBQVW-1} :test #'\nwlinkedidentc{appropriate-p}{NWlJ9ZL-ocPeo-1})) #'<
        :key #'(lambda (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})
                 (count-if #'(lambda (precond)
                               (not (\nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} precond state)))
                           (op-preconds \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})))))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{achieve}}{achieve}}\\{{\nwixident{appropriate-ops}}{appropriate-ops}}}\nwidentuses{\\{{\nwixident{*ops*}}{*ops*}}\\{{\nwixident{apply-op}}{apply-op}}\\{{\nwixident{appropriate-p}}{appropriate-p}}\\{{\nwixident{dbg-indent}}{dbg-indent}}\\{{\nwixident{find-all}}{find-all}}\\{{\nwixident{member-equal}}{member-equal}}\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{*ops*}}{*ops*}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{apply-op}}{apply-op}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{appropriate-p}}{appropriate-p}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{dbg-indent}}{dbg-indent}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{find-all}}{find-all}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{member-equal}}{member-equal}{NWlJ9ZL-1Tx3Kh-1}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-1Tx3Kh-1}\nwendcode{}\nwbegindocs{73}\nwdocspar

\nwenddocs{}\nwbegincode{74}\sublabel{NWlJ9ZL-ocPeo-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-ocPeo-1}}}\moddef{Decide if an operator is appropriate for a goal~{\nwtagstyle{}\subpageref{NWlJ9ZL-ocPeo-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{appropriate-p}{NWlJ9ZL-ocPeo-1} (goal \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})\nwindexdefn{\nwixident{appropriate-p}}{appropriate-p}{NWlJ9ZL-ocPeo-1}
  "An \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} is appropriate to a goal if it is in its add list."
  (\nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} goal (op-add-list \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{appropriate-p}}{appropriate-p}}}\nwidentuses{\\{{\nwixident{member-equal}}{member-equal}}\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{member-equal}}{member-equal}{NWlJ9ZL-ocPeo-1}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-ocPeo-1}\nwendcode{}\nwbegindocs{75}\nwdocspar

\nwenddocs{}\nwbegincode{76}\sublabel{NWlJ9ZL-3nt6zV-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3nt6zV-1}}}\moddef{Apply operator to current state~{\nwtagstyle{}\subpageref{NWlJ9ZL-3nt6zV-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{apply-op}{NWlJ9ZL-3nt6zV-1} (state goal \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} goal-stack)\nwindexdefn{\nwixident{apply-op}}{apply-op}{NWlJ9ZL-3nt6zV-1}
  "Return a new, transformed state if \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} is applicable."
  (\nwlinkedidentc{dbg-indent}{NWlJ9ZL-3LP9Za-1} :gps (length goal-stack) "Consider: ~a" (op-action \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}))
  (let ((state* (\nwlinkedidentc{achieve-all}{NWlJ9ZL-23MH3b-1} state (op-preconds \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})
                             (cons goal goal-stack))))
    (unless (null state*)
      (\nwlinkedidentc{dbg-indent}{NWlJ9ZL-3LP9Za-1} :gps (length goal-stack) "Action: ~a" (op-action \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}))
      (append (remove-if #'(lambda (x)
                             (\nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} x (op-del-list \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})))
                         state*)
              (op-add-list \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})))))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{apply-op}}{apply-op}}}\nwidentuses{\\{{\nwixident{achieve-all}}{achieve-all}}\\{{\nwixident{dbg-indent}}{dbg-indent}}\\{{\nwixident{member-equal}}{member-equal}}\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{achieve-all}}{achieve-all}{NWlJ9ZL-3nt6zV-1}\nwindexuse{\nwixident{dbg-indent}}{dbg-indent}{NWlJ9ZL-3nt6zV-1}\nwindexuse{\nwixident{member-equal}}{member-equal}{NWlJ9ZL-3nt6zV-1}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-3nt6zV-1}\nwendcode{}\nwbegindocs{77}\nwdocspar

\section{Auxiliary Functions}

\nwenddocs{}\nwbegincode{78}\sublabel{NWlJ9ZL-QzWjb-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-QzWjb-1}}}\moddef{Auxiliary Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-QzWjb-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
\LA{}Is a condition an executing form?~{\nwtagstyle{}\subpageref{NWlJ9ZL-3ZribA-1}}\RA{}

\LA{}Is x an action?~{\nwtagstyle{}\subpageref{NWlJ9ZL-lDJbR-1}}\RA{}

\LA{}Is the argument a list that starts with a given atom?~{\nwtagstyle{}\subpageref{NWlJ9ZL-26JY6E-1}}\RA{}

\LA{}Convert an operator to use the executing convention~{\nwtagstyle{}\subpageref{NWlJ9ZL-3MvEWn-1}}\RA{}

\LA{}Create an operator~{\nwtagstyle{}\subpageref{NWlJ9ZL-aGgy4-1}}\RA{}

\LA{}Use a list of of operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-3V5be-1}}\RA{}

\LA{}Test if an element is equal to a member of a list~{\nwtagstyle{}\subpageref{NWlJ9ZL-1aljzn-1}}\RA{}
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwendcode{}\nwbegindocs{79}\nwdocspar

\nwenddocs{}\nwbegincode{80}\sublabel{NWlJ9ZL-3ZribA-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3ZribA-1}}}\moddef{Is a condition an executing form?~{\nwtagstyle{}\subpageref{NWlJ9ZL-3ZribA-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{executing-p}{NWlJ9ZL-3ZribA-1} (x)\nwindexdefn{\nwixident{executing-p}}{executing-p}{NWlJ9ZL-3ZribA-1}
  "Is x of the form: (executing ...) ?"
  (\nwlinkedidentc{starts-with}{NWlJ9ZL-26JY6E-1} x 'executing))
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{executing-p}}{executing-p}}}\nwidentuses{\\{{\nwixident{starts-with}}{starts-with}}}\nwindexuse{\nwixident{starts-with}}{starts-with}{NWlJ9ZL-3ZribA-1}\nwendcode{}\nwbegindocs{81}\nwdocspar

\nwenddocs{}\nwbegincode{82}\sublabel{NWlJ9ZL-lDJbR-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-lDJbR-1}}}\moddef{Is x an action?~{\nwtagstyle{}\subpageref{NWlJ9ZL-lDJbR-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{action-p}{NWlJ9ZL-lDJbR-1} (x)\nwindexdefn{\nwixident{action-p}}{action-p}{NWlJ9ZL-lDJbR-1}
  "Is x something that is (start) or (executing ...)?"
  (or (equal x '(start)) (\nwlinkedidentc{executing-p}{NWlJ9ZL-3ZribA-1} x)))
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{action-p}}{action-p}}}\nwidentuses{\\{{\nwixident{executing-p}}{executing-p}}}\nwindexuse{\nwixident{executing-p}}{executing-p}{NWlJ9ZL-lDJbR-1}\nwendcode{}\nwbegindocs{83}\nwdocspar

\nwenddocs{}\nwbegincode{84}\sublabel{NWlJ9ZL-26JY6E-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-26JY6E-1}}}\moddef{Is the argument a list that starts with a given atom?~{\nwtagstyle{}\subpageref{NWlJ9ZL-26JY6E-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{starts-with}{NWlJ9ZL-26JY6E-1} (list x)\nwindexdefn{\nwixident{starts-with}}{starts-with}{NWlJ9ZL-26JY6E-1}
  "Is this a list whose first element is x?"
  (and (consp list) (eql (first list) x)))
\nwused{\\{NWlJ9ZL-QzWjb-1}\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{starts-with}}{starts-with}}}\nwendcode{}\nwbegindocs{85}\nwdocspar

\nwenddocs{}\nwbegincode{86}\sublabel{NWlJ9ZL-3MvEWn-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3MvEWn-1}}}\moddef{Convert an operator to use the executing convention~{\nwtagstyle{}\subpageref{NWlJ9ZL-3MvEWn-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{convert-op}{NWlJ9ZL-3MvEWn-1} (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})\nwindexdefn{\nwixident{convert-op}}{convert-op}{NWlJ9ZL-3MvEWn-1}
  "Make \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} conform to the (EXECUTING \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}) convention."
  (unless (some #'\nwlinkedidentc{executing-p}{NWlJ9ZL-3ZribA-1} (op-add-list \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}))
    (push (list 'executing (op-action \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})) (op-add-list \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})))
  \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1})
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{convert-op}}{convert-op}}}\nwidentuses{\\{{\nwixident{executing-p}}{executing-p}}\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{executing-p}}{executing-p}{NWlJ9ZL-3MvEWn-1}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-3MvEWn-1}\nwendcode{}\nwbegindocs{87}\nwdocspar

\nwenddocs{}\nwbegincode{88}\sublabel{NWlJ9ZL-aGgy4-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-aGgy4-1}}}\moddef{Create an operator~{\nwtagstyle{}\subpageref{NWlJ9ZL-aGgy4-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} (action &key preconds add-list del-list)\nwindexdefn{\nwixident{op}}{op}{NWlJ9ZL-aGgy4-1}
  "Make a new operator that obeys the (EXECUTING \nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1}) convention."
  (\nwlinkedidentc{convert-op}{NWlJ9ZL-3MvEWn-1} (make-op :action action
                       :preconds preconds
                       :add-list add-list
                       :del-list del-list)))
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{op}}{op}}}\nwidentuses{\\{{\nwixident{convert-op}}{convert-op}}}\nwindexuse{\nwixident{convert-op}}{convert-op}{NWlJ9ZL-aGgy4-1}\nwendcode{}\nwbegindocs{89}\nwdocspar

\nwenddocs{}\nwbegincode{90}\sublabel{NWlJ9ZL-yooUt-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-yooUt-1}}}\moddef{Convert existing operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-yooUt-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(mapc #'\nwlinkedidentc{convert-op}{NWlJ9ZL-3MvEWn-1} \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentuses{\\{{\nwixident{*school-ops*}}{*school-ops*}}\\{{\nwixident{convert-op}}{convert-op}}}\nwindexuse{\nwixident{*school-ops*}}{*school-ops*}{NWlJ9ZL-yooUt-1}\nwindexuse{\nwixident{convert-op}}{convert-op}{NWlJ9ZL-yooUt-1}\nwendcode{}\nwbegindocs{91}\nwdocspar

\nwenddocs{}\nwbegincode{92}\sublabel{NWlJ9ZL-3V5be-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3V5be-1}}}\moddef{Use a list of of operators~{\nwtagstyle{}\subpageref{NWlJ9ZL-3V5be-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} (oplist)\nwindexdefn{\nwixident{use}}{use}{NWlJ9ZL-3V5be-1}
  "Use oplist as the default list of operators."
  (length (setf \nwlinkedidentc{*ops*}{NWlJ9ZL-1JBQVW-1} oplist)))
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{use}}{use}}}\nwidentuses{\\{{\nwixident{*ops*}}{*ops*}}}\nwindexuse{\nwixident{*ops*}}{*ops*}{NWlJ9ZL-3V5be-1}\nwendcode{}\nwbegindocs{93}\nwdocspar

\nwenddocs{}\nwbegincode{94}\sublabel{NWlJ9ZL-1aljzn-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1aljzn-1}}}\moddef{Test if an element is equal to a member of a list~{\nwtagstyle{}\subpageref{NWlJ9ZL-1aljzn-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-QzWjb-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{member-equal}{NWlJ9ZL-1aljzn-1} (item list)\nwindexdefn{\nwixident{member-equal}}{member-equal}{NWlJ9ZL-1aljzn-1}
  (member item list :test #'equal))
\nwused{\\{NWlJ9ZL-QzWjb-1}}\nwidentdefs{\\{{\nwixident{member-equal}}{member-equal}}}\nwendcode{}\nwbegindocs{95}\nwdocspar

\section{Nursery School Example}

To drive the son to school, the son must start at home and the car must work.
\nwenddocs{}\nwbegincode{96}\sublabel{NWlJ9ZL-31LYLP-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-31LYLP-1}}}\moddef{Drive son to school~{\nwtagstyle{}\subpageref{NWlJ9ZL-31LYLP-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4Zg5N4-1}}\nwenddeflinemarkup
(make-op :action 'drive-son-to-school
         :preconds '(son-at-home car-works)
         :add-list '(son-at-school)
         :del-list '(son-at-home))
\nwused{\\{NWlJ9ZL-4Zg5N4-1}}\nwendcode{}\nwbegindocs{97}\nwdocspar

\nwenddocs{}\nwbegincode{98}\sublabel{NWlJ9ZL-4Zg5N4-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zg5N4-1}}}\moddef{Nursery School Example~{\nwtagstyle{}\subpageref{NWlJ9ZL-4Zg5N4-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defparameter \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1}
  (list
   \LA{}Drive son to school~{\nwtagstyle{}\subpageref{NWlJ9ZL-31LYLP-1}}\RA{}
   (make-op :action 'shop-installs-battery
            :preconds '(car-needs-battery shop-knows-problem shop-has-money)
            :add-list '(car-works))
   (make-op :action 'tell-shop-problem
            :preconds '(in-communication-with-shop)
            :add-list '(shop-knows-problem))
   (make-op :action 'telephone-shop
            :preconds '(know-phone-number)
            :add-list '(in-communication-with-shop))
   (make-op :action 'look-up-number
            :preconds '(have-phone-book)
            :add-list '(know-phone-number))
   (make-op :action 'give-shop-money
            :preconds '(have-money)
            :add-list '(shop-has-money)
            :del-list '(have-money))))
\nwindexdefn{\nwixident{*school-ops*}}{*school-ops*}{NWlJ9ZL-4Zg5N4-1}\eatline
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{*school-ops*}}{*school-ops*}}}\nwendcode{}\nwbegindocs{99}\nwdocspar
\section{Monkey and Bananas}

\nwenddocs{}\nwbegincode{100}\sublabel{NWlJ9ZL-GNLBM-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-GNLBM-1}}}\moddef{Monkey and Bananas Example~{\nwtagstyle{}\subpageref{NWlJ9ZL-GNLBM-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defparameter *banana-ops*
  (list
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'climb-on-chair
       :preconds '(chair-at-middle-room at-middle-room on-floor)
       :add-list '(at-bananas on-chair)
       :del-list '(at-middle-room on-floor))
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'push-chair-from-door-to-middle-room
       :preconds '(chair-at-door at-door)
       :add-list '(chair-at-middle-room at-middle-room)
       :del-list '(chair-at-door at-door))
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'walk-from-door-to-middle-room
       :preconds '(at-door on-floor)
       :add-list '(at-middle-room)
       :del-list '(at-door))
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'grasp-bananas
       :preconds '(at-bananas empty-handed)
       :add-list '(has-bananas)
       :del-list '(empty-handed))
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'drop-ball
       :preconds '(has-ball)
       :add-list '(empty-handed)
       :del-list '(has-ball))
   (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} 'eat-bananas
       :preconds '(has-bananas)
       :add-list '(empty-handed not-hungry)
       :del-list '(has-bananas hungry))))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentuses{\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-GNLBM-1}\nwendcode{}\nwbegindocs{101}\nwdocspar

\section{The Maze Searching Domain}

\nwenddocs{}\nwbegincode{102}\sublabel{NWlJ9ZL-2DSCmQ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2DSCmQ-1}}}\moddef{The Maze Searching Domain~{\nwtagstyle{}\subpageref{NWlJ9ZL-2DSCmQ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{make-maze-ops}{NWlJ9ZL-2DSCmQ-1} (pair)\nwindexdefn{\nwixident{make-maze-ops}}{make-maze-ops}{NWlJ9ZL-2DSCmQ-1}
  "Make maze ops in both directions."
  (list (\nwlinkedidentc{make-maze-op}{NWlJ9ZL-2DSCmQ-1} (first pair) (second pair))
        (\nwlinkedidentc{make-maze-op}{NWlJ9ZL-2DSCmQ-1} (second pair) (first pair))))

(defun \nwlinkedidentc{make-maze-op}{NWlJ9ZL-2DSCmQ-1} (here there)\nwindexdefn{\nwixident{make-maze-op}}{make-maze-op}{NWlJ9ZL-2DSCmQ-1}
  "Make an operator to move between two places."
  (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} `(move from ,here to ,there)
      :preconds `((at ,here))
      :add-list `((at ,there))
      :del-list `((at ,here))))

(defparameter *maze-ops*
  (\nwlinkedidentc{mappend}{NWlJ9ZL-4BOcTg-1} #'\nwlinkedidentc{make-maze-ops}{NWlJ9ZL-2DSCmQ-1}
    '((1 2) (2 3) (3 4) (4 9) (9 14) (9 8) (8 7) (7 12) (12 13)
      (12 11) (11 6) (11 16) (16 17) (17 22) (21 22) (22 23)
      (23 18) (23 24) (24 19) (19 20) (20 15) (15 10) (10 5) (20 25))))

(defun \nwlinkedidentc{find-path}{NWlJ9ZL-2DSCmQ-1} (start end)\nwindexdefn{\nwixident{find-path}}{find-path}{NWlJ9ZL-2DSCmQ-1}
  "Search a maze for a path from start to end."
  (let ((results (\nwlinkedidentc{GPS}{NWlJ9ZL-30p2tX-1} `((at ,start)) `((at ,end)))))
    (unless (null results)
      (cons start (mapcar #'\nwlinkedidentc{destination}{NWlJ9ZL-2DSCmQ-1}
                          (remove '(start) results
                                  :test #'equal))))))

(defun \nwlinkedidentc{destination}{NWlJ9ZL-2DSCmQ-1} (action)\nwindexdefn{\nwixident{destination}}{destination}{NWlJ9ZL-2DSCmQ-1}
  "Find the Y in (executing (move from X to Y))."
  (fifth (second action)))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{destination}}{destination}}\\{{\nwixident{find-path}}{find-path}}\\{{\nwixident{make-maze-op}}{make-maze-op}}\\{{\nwixident{make-maze-ops}}{make-maze-ops}}}\nwidentuses{\\{{\nwixident{GPS}}{GPS}}\\{{\nwixident{mappend}}{mappend}}\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{GPS}}{GPS}{NWlJ9ZL-2DSCmQ-1}\nwindexuse{\nwixident{mappend}}{mappend}{NWlJ9ZL-2DSCmQ-1}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-2DSCmQ-1}\nwendcode{}\nwbegindocs{103}\nwdocspar

\subsection{Tests}

\nwenddocs{}\nwbegincode{104}\sublabel{NWlJ9ZL-v1OUw-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-v1OUw-1}}}\moddef{Maze Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-v1OUw-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(define-test maze
  (\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} *maze-ops*)
  (assert-equal '(1 2 3 4 9 8 7 12 11 16 17 22 23 24 19 20 25)
                (\nwlinkedidentc{find-path}{NWlJ9ZL-2DSCmQ-1} 1 25)))

(define-test go-nowhere
  (\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} *maze-ops*)
  (assert-equal '(1) (\nwlinkedidentc{find-path}{NWlJ9ZL-2DSCmQ-1} 1 1)))

(define-test maze-reverse
  (\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} *maze-ops*)
  (assert-equal (\nwlinkedidentc{find-path}{NWlJ9ZL-2DSCmQ-1} 1 25) (reverse (\nwlinkedidentc{find-path}{NWlJ9ZL-2DSCmQ-1} 25 1))))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentuses{\\{{\nwixident{find-path}}{find-path}}\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{find-path}}{find-path}{NWlJ9ZL-v1OUw-1}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-v1OUw-1}\nwendcode{}\nwbegindocs{105}\nwdocspar

\begin{quote}
  The moral is that when a programmer uses puns—saying what's convenient instead
  of what's really happening--there's bound to be trouble.
\end{quote}

\section{The Blocks World Domain}

\nwenddocs{}\nwbegincode{106}\sublabel{NWlJ9ZL-1t2bMc-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1t2bMc-1}}}\moddef{The Blocks World Domain~{\nwtagstyle{}\subpageref{NWlJ9ZL-1t2bMc-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{make-block-ops}{NWlJ9ZL-1t2bMc-1} (blocks)\nwindexdefn{\nwixident{make-block-ops}}{make-block-ops}{NWlJ9ZL-1t2bMc-1}
  (let ((ops nil))
    (dolist (a blocks)
      (dolist (b blocks)
        (unless (equal a b)
          (dolist (c blocks)
            (unless (or (equal c a)
                        (equal c b))
              (push (\nwlinkedidentc{move-op}{NWlJ9ZL-1t2bMc-1} a b c) ops)))
          (push (\nwlinkedidentc{move-op}{NWlJ9ZL-1t2bMc-1} a 'table b) ops)
          (push (\nwlinkedidentc{move-op}{NWlJ9ZL-1t2bMc-1} a b 'table) ops))))
    ops))

(defun \nwlinkedidentc{move-op}{NWlJ9ZL-1t2bMc-1} (a b c)\nwindexdefn{\nwixident{move-op}}{move-op}{NWlJ9ZL-1t2bMc-1}
  "Make an operator to move A from B to C."
  (\nwlinkedidentc{op}{NWlJ9ZL-aGgy4-1} `(move ,a from ,b to ,c)
      :preconds `((space on ,a) (space on ,c) (,a on ,b))
      :add-list (\nwlinkedidentc{move-ons}{NWlJ9ZL-1t2bMc-1} a b c)
      :del-list (\nwlinkedidentc{move-ons}{NWlJ9ZL-1t2bMc-1} a c b)))

(defun \nwlinkedidentc{move-ons}{NWlJ9ZL-1t2bMc-1} (a b c)\nwindexdefn{\nwixident{move-ons}}{move-ons}{NWlJ9ZL-1t2bMc-1}
  (if (eq b 'table)
      `((,a on ,c))
      `((,a on ,c) (space on ,b))))

\LA{}Blocks World Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-8artJ-1}}\RA{}
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{make-block-ops}}{make-block-ops}}\\{{\nwixident{move-ons}}{move-ons}}\\{{\nwixident{move-op}}{move-op}}}\nwidentuses{\\{{\nwixident{op}}{op}}}\nwindexuse{\nwixident{op}}{op}{NWlJ9ZL-1t2bMc-1}\nwendcode{}\nwbegindocs{107}\nwdocspar

\nwenddocs{}\nwbegincode{108}\sublabel{NWlJ9ZL-8artJ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-8artJ-1}}}\moddef{Blocks World Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-8artJ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-1t2bMc-1}}\nwenddeflinemarkup
(define-test simplest-blocks-problem
  (\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} (\nwlinkedidentc{make-block-ops}{NWlJ9ZL-1t2bMc-1} '(a b)))
  (assert-equal '((start) (executing (move a from table to b)))
                (gps '((a on table) (b on table) (space on a) (space on b)
                       (space on table))
                     '((a on b) (b on table)))))

(define-test slighty-more-complex-blocks
  (\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} (\nwlinkedidentc{make-block-ops}{NWlJ9ZL-1t2bMc-1} '(a b)))
  (assert-equal '((start)
                  (executing (move a from b to table))
                  (executing (move b from table to a)))
                (gps '((a on b) (b on table) (space on a) (space on table))
                     '((b on a)))))

(define-test blocks-goals-order-insignificant
  (let ((ops (\nwlinkedidentc{make-block-ops}{NWlJ9ZL-1t2bMc-1} '(a b c))))
    (let ((state '((a on b) (b on c) (c on table)
                   (space on a) (space on table))))
      (assert-equal '((start)
                      (executing (move a from b to table))
                      (executing (move b from c to a))
                      (executing (move c from table to b)))
                    (gps state '((b on a) (c on b)) ops))
      (assert-equal '((start)
                      (executing (move a from b to table))
                      (executing (move b from c to a))
                      (executing (move c from table to b)))
                    (gps state '((c on b) (b on a)) ops)))))

(define-test blocks-ops-ordered-intelligently
  (let ((ops (\nwlinkedidentc{make-block-ops}{NWlJ9ZL-1t2bMc-1} '(a b c))))
    (let ((state '((c on a) (a on table) (b on table)
                   (space on c) (space on b) (space on table))))
      (assert-equal '((start)
                      (executing (move c from a to table))
                      (executing (move a from table to b)))
                    (gps state '((c on table) (a on b)) ops)))
    (let ((state '((a on b) (b on c) (c on table)
                   (space on a) (space on table))))
      (assert-equal '((start)
                      (executing (move a from b to table))
                      (executing (move b from c to a))
                      (executing (move c from table to b)))
                    (gps state '((b on a) (c on b)) ops))
      (assert-equal '((start)
                      (executing (move a from b to table))
                      (executing (move b from c to a))
                      (executing (move c from table to b)))
                    (gps state '((c on b) (b on a)) ops)))))

\LA{}Blocks: The Sussman Anomaly~{\nwtagstyle{}\subpageref{NWlJ9ZL-2FEfPq-1}}\RA{}
\nwused{\\{NWlJ9ZL-1t2bMc-1}}\nwidentuses{\\{{\nwixident{make-block-ops}}{make-block-ops}}\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{make-block-ops}}{make-block-ops}{NWlJ9ZL-8artJ-1}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-8artJ-1}\nwendcode{}\nwbegindocs{109}\nwdocspar

\subsection{The Sussman Anomaly}

N.B. These results are undesirable and will be addressed in chapter 6.
\nwenddocs{}\nwbegincode{110}\sublabel{NWlJ9ZL-2FEfPq-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2FEfPq-1}}}\moddef{Blocks: The Sussman Anomaly~{\nwtagstyle{}\subpageref{NWlJ9ZL-2FEfPq-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-8artJ-1}}\nwenddeflinemarkup
(define-test blocks-the-sussman-anomaly
  (let ((start '((c on a) (a on table) (b on table)
                 (space on c) (space on b) (space on table))))
    (assert-nil (gps start '((a on b) (b on c))))
    (assert-nil (gps start '((b on c) (a on b))))))
\nwused{\\{NWlJ9ZL-8artJ-1}}\nwendcode{}\nwbegindocs{111}\nwdocspar

\section{Debugging}

\nwenddocs{}\nwbegincode{112}\sublabel{NWlJ9ZL-3AihUJ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3AihUJ-1}}}\moddef{Debugging usage~{\nwtagstyle{}\subpageref{NWlJ9ZL-3AihUJ-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
;; Example call
(\nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1} :gps "The current goal is: ~a" goal)

;; Turn on debugging
(\nwlinkedidentc{debug}{NWlJ9ZL-3LP9Za-1} :gps)

;; Turn off debugging
(\nwlinkedidentc{undebug}{NWlJ9ZL-3LP9Za-1} :gps)
\nwnotused{Debugging usage}\nwidentuses{\\{{\nwixident{dbg}}{dbg}}\\{{\nwixident{debug}}{debug}}\\{{\nwixident{undebug}}{undebug}}}\nwindexuse{\nwixident{dbg}}{dbg}{NWlJ9ZL-3AihUJ-1}\nwindexuse{\nwixident{debug}}{debug}{NWlJ9ZL-3AihUJ-1}\nwindexuse{\nwixident{undebug}}{undebug}{NWlJ9ZL-3AihUJ-1}\nwendcode{}\nwbegindocs{113}\nwdocspar

\nwenddocs{}\nwbegincode{114}\sublabel{NWlJ9ZL-3LP9Za-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3LP9Za-1}}}\moddef{Print debugging information~{\nwtagstyle{}\subpageref{NWlJ9ZL-3LP9Za-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(defvar \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1} nil\nwindexdefn{\nwixident{*dbg-ids*}}{*dbg-ids*}{NWlJ9ZL-3LP9Za-1}
  "Identifiers used by \nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1}")

(defun \nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1} (id format-string &rest args)\nwindexdefn{\nwixident{dbg}}{dbg}{NWlJ9ZL-3LP9Za-1}
  "Print debugging info if (DEBUG ID) has been specified."
  (when (member id \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1})
    (format *debug-io* "~&~?" format-string args)))

(defun \nwlinkedidentc{debug}{NWlJ9ZL-3LP9Za-1} (&rest ids)\nwindexdefn{\nwixident{debug}}{debug}{NWlJ9ZL-3LP9Za-1}
  "Start \nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1} output on the given ids."
  (setf \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1} (union ids \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1})))

(defun \nwlinkedidentc{undebug}{NWlJ9ZL-3LP9Za-1} (&rest ids)\nwindexdefn{\nwixident{undebug}}{undebug}{NWlJ9ZL-3LP9Za-1}
  "Stop \nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1} on the ids. With no ids, stop \nwlinkedidentc{dbg}{NWlJ9ZL-3LP9Za-1} altogether."
  (setf \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1} (if (null ids) nil
                      (set-difference \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1} ids))))

(defun \nwlinkedidentc{dbg-indent}{NWlJ9ZL-3LP9Za-1} (id indent format-string &rest args)\nwindexdefn{\nwixident{dbg-indent}}{dbg-indent}{NWlJ9ZL-3LP9Za-1}
  "Print indented debugging info if (DEBUG ID) has been specified."
  (when (member id \nwlinkedidentc{*dbg-ids*}{NWlJ9ZL-3LP9Za-1})
    (format *debug-io* "~&~V@T~?" (* 2 indent) format-string args)))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentdefs{\\{{\nwixident{*dbg-ids*}}{*dbg-ids*}}\\{{\nwixident{dbg}}{dbg}}\\{{\nwixident{dbg-indent}}{dbg-indent}}\\{{\nwixident{debug}}{debug}}\\{{\nwixident{undebug}}{undebug}}}\nwendcode{}\nwbegindocs{115}\nwdocspar

\section{Exercises}

\subsection{Exercise 4.2}

\nwenddocs{}\nwbegincode{116}\sublabel{NWlJ9ZL-4ArfbM-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4ArfbM-1}}}\moddef{permutations~{\nwtagstyle{}\subpageref{NWlJ9ZL-4ArfbM-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(defun \nwlinkedidentc{permutations}{NWlJ9ZL-4ArfbM-1} (xs)\nwindexdefn{\nwixident{permutations}}{permutations}{NWlJ9ZL-4ArfbM-1}
  (if (endp (cdr xs))
      (list xs)
      (loop for x in xs
            append (loop for ys in (\nwlinkedidentc{permutations}{NWlJ9ZL-4ArfbM-1} (remove x xs :count 1
                                                              :test  #'eq))
                         collect (cons x ys)))))
\nwnotused{permutations}\nwidentdefs{\\{{\nwixident{permutations}}{permutations}}}\nwendcode{}\nwbegindocs{117}\nwdocspar

\section{Tests}

\nwenddocs{}\nwbegincode{118}\sublabel{NWlJ9ZL-1ahSlC-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1ahSlC-1}}}\moddef{GPS Tests~{\nwtagstyle{}\subpageref{NWlJ9ZL-1ahSlC-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-wDl5T-1}}\nwenddeflinemarkup
(define-test complex
  (assert-equal
   (cons '(start)
         (mapcar #'(lambda (step) (list 'executing step))
                 '(look-up-number
                   telephone-shop
                   tell-shop-problem
                   give-shop-money
                   shop-installs-battery
                   drive-son-to-school)))
   (gps '(son-at-home car-needs-battery have-money have-phone-book)
        '(son-at-school)
        \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})))

(define-test unsolvable
  (assert-nil (gps '(son-at-home car-needs-battery have-money)
                   '(son-at-school)
                   \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})))

(define-test simple
  (assert-equal '((start) (executing drive-son-to-school))
                (gps '(son-at-home car-works)
                     '(son-at-school)
                     \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})))

(define-test money-leftover
  (assert-equal '((start) (executing drive-son-to-school))
                (gps '(son-at-home have-money car-works)
                     '(have-money son-at-school)
                     \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})))

(define-test clobbered-sibling
  (assert-nil (gps '(son-at-home car-needs-battery have-money have-phone-book)
                   '(have-money son-at-school)
                   \nwlinkedidentc{*school-ops*}{NWlJ9ZL-4Zg5N4-1})))
\nwused{\\{NWlJ9ZL-wDl5T-1}}\nwidentuses{\\{{\nwixident{*school-ops*}}{*school-ops*}}}\nwindexuse{\nwixident{*school-ops*}}{*school-ops*}{NWlJ9ZL-1ahSlC-1}\nwendcode{}\nwbegindocs{119}\nwdocspar

\chapter{{\sc Eliza}: Dialog with a Machine}

\marginnote[\baselineskip]{
  {\sc Eliza}, one of the more well-known AI programs of the 1960s, simulates a
  psychotherapist, by way of a REPL.
}

\nwenddocs{}\nwbegincode{120}\sublabel{NWlJ9ZL-3P1OfB-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3P1OfB-1}}}\moddef{src/eliza.lisp~{\nwtagstyle{}\subpageref{NWlJ9ZL-3P1OfB-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(in-package #:paip)
(defpackage #:paip.eliza
  (:\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} #:cl #:lisp-unit))
(in-package #:paip.eliza)

\LA{}ELIZA: Constants~{\nwtagstyle{}\subpageref{NWlJ9ZL-2EiFV2-1}}\RA{}

\LA{}ELIZA: Top-Level Function~{\nwtagstyle{}\subpageref{NWlJ9ZL-2T7eg6-1}}\RA{}

\LA{}ELIZA: Special Variables~{\nwtagstyle{}\subpageref{NWlJ9ZL-24Hem4-1}}\RA{}

\LA{}ELIZA: Data Types~{\nwtagstyle{}\subpageref{NWlJ9ZL-3jvCTM-1}}\RA{}

\LA{}ELIZA: Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-4MxtLd-1}}\RA{}
\nwnotused{src/eliza.lisp}\nwidentuses{\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-3P1OfB-1}\nwendcode{}\nwbegindocs{121}\nwdocspar

\section{Pattern Matching}

\marginnote[\baselineskip]{
  {\sc Eliza} makes heavy use of pattern matching, which is at once versatile
  and limited.
}

\nwenddocs{}\nwbegincode{122}\sublabel{NWlJ9ZL-fP7AE-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-fP7AE-1}}}\moddef{ELIZA: Pattern Matching~{\nwtagstyle{}\subpageref{NWlJ9ZL-fP7AE-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
\LA{}pat-match~{\nwtagstyle{}\subpageref{NWlJ9ZL-3nmfAz-1}}\RA{}

\LA{}match-variable~{\nwtagstyle{}\subpageref{NWlJ9ZL-1BlMBi-1}}\RA{}

\LA{}segment-match~{\nwtagstyle{}\subpageref{NWlJ9ZL-1VV14C-1}}\RA{}

\LA{}segment-pattern-p~{\nwtagstyle{}\subpageref{NWlJ9ZL-Sl3Ms-1}}\RA{}

\LA{}variable-p~{\nwtagstyle{}\subpageref{NWlJ9ZL-1JbiwF-1}}\RA{}
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwendcode{}\nwbegindocs{123}\nwdocspar

\subsection{Matching}

\marginnote[\baselineskip]{%
  Verify \lsp{var} is bound to \lsp{input} in \lsp{bindings}. If bound to
  another value, {\Tt{}\nwlinkedidentq{fail}{NWlJ9ZL-2EiFV2-1}\nwendquote}. If unbound, {\Tt{}\nwlinkedidentq{extend-bindings}{NWlJ9ZL-JLGGa-1}\nwendquote}.
}

\nwenddocs{}\nwbegincode{124}\sublabel{NWlJ9ZL-1BlMBi-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1BlMBi-1}}}\moddef{match-variable~{\nwtagstyle{}\subpageref{NWlJ9ZL-1BlMBi-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-fP7AE-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{match-variable}{NWlJ9ZL-1BlMBi-1} (var input bindings)\nwindexdefn{\nwixident{match-variable}}{match-variable}{NWlJ9ZL-1BlMBi-1}
  "Does VAR match input? Uses (or updates) and returns bindings."
  (let ((binding (\nwlinkedidentc{get-binding}{NWlJ9ZL-JLGGa-1} var bindings)))
    (cond ((not binding) (\nwlinkedidentc{extend-bindings}{NWlJ9ZL-JLGGa-1} var input bindings))
          ((equal input (\nwlinkedidentc{binding-val}{NWlJ9ZL-JLGGa-1} binding)) bindings)
          (t \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1}))))
\nwused{\\{NWlJ9ZL-fP7AE-1}}\nwidentdefs{\\{{\nwixident{match-variable}}{match-variable}}}\nwidentuses{\\{{\nwixident{binding-val}}{binding-val}}\\{{\nwixident{extend-bindings}}{extend-bindings}}\\{{\nwixident{fail}}{fail}}\\{{\nwixident{get-binding}}{get-binding}}}\nwindexuse{\nwixident{binding-val}}{binding-val}{NWlJ9ZL-1BlMBi-1}\nwindexuse{\nwixident{extend-bindings}}{extend-bindings}{NWlJ9ZL-1BlMBi-1}\nwindexuse{\nwixident{fail}}{fail}{NWlJ9ZL-1BlMBi-1}\nwindexuse{\nwixident{get-binding}}{get-binding}{NWlJ9ZL-1BlMBi-1}\nwendcode{}\nwbegindocs{125}\nwdocspar

\nwenddocs{}\nwbegincode{126}\sublabel{NWlJ9ZL-3nmfAz-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3nmfAz-1}}}\moddef{pat-match~{\nwtagstyle{}\subpageref{NWlJ9ZL-3nmfAz-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-fP7AE-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} (pattern input &optional (bindings \nwlinkedidentc{no-bindings}{NWlJ9ZL-2EiFV2-1}))\nwindexdefn{\nwixident{pat-match}}{pat-match}{NWlJ9ZL-3nmfAz-1}
  "Match pattern against input in the context of the bindings."
  (cond \LA{}Fail if the binding list is \lsp{fail}~{\nwtagstyle{}\subpageref{NWlJ9ZL-1NgPsX-1}}\RA{}
        \LA{}Match a variable~{\nwtagstyle{}\subpageref{NWlJ9ZL-1c11Uf-1}}\RA{}
        \LA{}If \lsp{pattern} equals \lsp{input}, return \lsp{bindings}~{\nwtagstyle{}\subpageref{NWlJ9ZL-3hXqLN-1}}\RA{}
        \LA{}Match a segment~{\nwtagstyle{}\subpageref{NWlJ9ZL-GZe9f-1}}\RA{}
        \LA{}Call \code{}pat-match\edoc{} recursively~{\nwtagstyle{}\subpageref{NWlJ9ZL-4cCTse-1}}\RA{}
        (t \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1})))
\nwused{\\{NWlJ9ZL-fP7AE-1}}\nwidentdefs{\\{{\nwixident{pat-match}}{pat-match}}}\nwidentuses{\\{{\nwixident{fail}}{fail}}\\{{\nwixident{no-bindings}}{no-bindings}}}\nwindexuse{\nwixident{fail}}{fail}{NWlJ9ZL-3nmfAz-1}\nwindexuse{\nwixident{no-bindings}}{no-bindings}{NWlJ9ZL-3nmfAz-1}\nwendcode{}\nwbegindocs{127}\nwdocspar

\marginnote[\baselineskip]{%
  If the binding list is {\Tt{}\nwlinkedidentq{fail}{NWlJ9ZL-2EiFV2-1}\nwendquote}, then the match fails, because some previous
  match must have failed.
}

\nwenddocs{}\nwbegincode{128}\sublabel{NWlJ9ZL-1NgPsX-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1NgPsX-1}}}\moddef{Fail if the binding list is \lsp{fail}~{\nwtagstyle{}\subpageref{NWlJ9ZL-1NgPsX-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3nmfAz-1}}\nwenddeflinemarkup
((eq bindings \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1}) \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1})
\nwused{\\{NWlJ9ZL-3nmfAz-1}}\nwidentuses{\\{{\nwixident{fail}}{fail}}}\nwindexuse{\nwixident{fail}}{fail}{NWlJ9ZL-1NgPsX-1}\nwendcode{}\nwbegindocs{129}\nwdocspar

\marginnote[\baselineskip]{%
  If the \lsp{pattern} is a single variable, return the result of
  {\Tt{}\nwlinkedidentq{match-variable}{NWlJ9ZL-1BlMBi-1}\nwendquote}; either \lsp{bindings} (possibly extended) or {\Tt{}\nwlinkedidentq{fail}{NWlJ9ZL-2EiFV2-1}\nwendquote}.
}

\nwenddocs{}\nwbegincode{130}\sublabel{NWlJ9ZL-1c11Uf-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1c11Uf-1}}}\moddef{Match a variable~{\nwtagstyle{}\subpageref{NWlJ9ZL-1c11Uf-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3nmfAz-1}}\nwenddeflinemarkup
((\nwlinkedidentc{variable-p}{NWlJ9ZL-1JbiwF-1} pattern) (\nwlinkedidentc{match-variable}{NWlJ9ZL-1BlMBi-1} pattern input bindings))
\nwused{\\{NWlJ9ZL-3nmfAz-1}}\nwidentuses{\\{{\nwixident{match-variable}}{match-variable}}\\{{\nwixident{variable-p}}{variable-p}}}\nwindexuse{\nwixident{match-variable}}{match-variable}{NWlJ9ZL-1c11Uf-1}\nwindexuse{\nwixident{variable-p}}{variable-p}{NWlJ9ZL-1c11Uf-1}\nwendcode{}\nwbegindocs{131}\nwdocspar

\marginnote[0.5\baselineskip]{%
  If \lsp{pattern} equals \lsp{input}, return \lsp{bindings} as is.
}

\nwenddocs{}\nwbegincode{132}\sublabel{NWlJ9ZL-3hXqLN-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3hXqLN-1}}}\moddef{If \lsp{pattern} equals \lsp{input}, return \lsp{bindings}~{\nwtagstyle{}\subpageref{NWlJ9ZL-3hXqLN-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3nmfAz-1}}\nwenddeflinemarkup
((eql pattern input) bindings)
\nwused{\\{NWlJ9ZL-3nmfAz-1}}\nwendcode{}\nwbegindocs{133}\nwdocspar

\marginnote[\baselineskip]{%
  When both \lsp{pattern} and \lsp{input} are lists and the \lsp{(car pattern)}
  is a segment variable, match the variable to the initial part of the
  \lsp{input} and attempt to match \lsp{(cdr pattern)} to the rest.
}

\nwenddocs{}\nwbegincode{134}\sublabel{NWlJ9ZL-GZe9f-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-GZe9f-1}}}\moddef{Match a segment~{\nwtagstyle{}\subpageref{NWlJ9ZL-GZe9f-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3nmfAz-1}}\nwenddeflinemarkup
((\nwlinkedidentc{segment-pattern-p}{NWlJ9ZL-Sl3Ms-1} pattern) (\nwlinkedidentc{segment-match}{NWlJ9ZL-1VV14C-1} pattern input bindings))
\nwused{\\{NWlJ9ZL-3nmfAz-1}}\nwidentuses{\\{{\nwixident{segment-match}}{segment-match}}\\{{\nwixident{segment-pattern-p}}{segment-pattern-p}}}\nwindexuse{\nwixident{segment-match}}{segment-match}{NWlJ9ZL-GZe9f-1}\nwindexuse{\nwixident{segment-pattern-p}}{segment-pattern-p}{NWlJ9ZL-GZe9f-1}\nwendcode{}\nwbegindocs{135}\nwdocspar

\nwenddocs{}\nwbegincode{136}\sublabel{NWlJ9ZL-4cCTse-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4cCTse-1}}}\moddef{Call \code{}pat-match\edoc{} recursively~{\nwtagstyle{}\subpageref{NWlJ9ZL-4cCTse-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3nmfAz-1}}\nwenddeflinemarkup
((and (consp pattern) (consp input))
 (\nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} (rest pattern) (rest input)
            (\nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} (first pattern) (first input)
                       bindings)))
\nwused{\\{NWlJ9ZL-3nmfAz-1}}\nwidentuses{\\{{\nwixident{pat-match}}{pat-match}}}\nwindexuse{\nwixident{pat-match}}{pat-match}{NWlJ9ZL-4cCTse-1}\nwendcode{}\nwbegindocs{137}\nwdocspar



\nwenddocs{}\nwbegincode{138}\sublabel{NWlJ9ZL-1VV14C-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1VV14C-1}}}\moddef{segment-match~{\nwtagstyle{}\subpageref{NWlJ9ZL-1VV14C-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-fP7AE-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{segment-match}{NWlJ9ZL-1VV14C-1} (pattern input bindings &optional (start 0))\nwindexdefn{\nwixident{segment-match}}{segment-match}{NWlJ9ZL-1VV14C-1}
  "Match the segment pattern ((?* var) . pat) against input."
  (let ((var (second (first pattern)))
        (pat (rest pattern)))
    (if (null pat)
        (\nwlinkedidentc{match-variable}{NWlJ9ZL-1BlMBi-1} var input bindings)
        (let ((pos (position (first pat) input
                             :start start :test #'equal)))
          (if (null pos)
              \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1}
              (let ((b2 (\nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} pat (subseq input pos) bindings)))
                (if (eq b2 \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1})
                    (\nwlinkedidentc{segment-match}{NWlJ9ZL-1VV14C-1} pattern input bindings (+ pos 1))
                    (\nwlinkedidentc{match-variable}{NWlJ9ZL-1BlMBi-1} var (subseq input 0 pos) b2))))))))
\nwused{\\{NWlJ9ZL-fP7AE-1}}\nwidentdefs{\\{{\nwixident{segment-match}}{segment-match}}}\nwidentuses{\\{{\nwixident{fail}}{fail}}\\{{\nwixident{match-variable}}{match-variable}}\\{{\nwixident{pat-match}}{pat-match}}}\nwindexuse{\nwixident{fail}}{fail}{NWlJ9ZL-1VV14C-1}\nwindexuse{\nwixident{match-variable}}{match-variable}{NWlJ9ZL-1VV14C-1}\nwindexuse{\nwixident{pat-match}}{pat-match}{NWlJ9ZL-1VV14C-1}\nwendcode{}\nwbegindocs{139}\nwdocspar

\subsection{Predicates}

\nwenddocs{}\nwbegincode{140}\sublabel{NWlJ9ZL-Sl3Ms-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-Sl3Ms-1}}}\moddef{segment-pattern-p~{\nwtagstyle{}\subpageref{NWlJ9ZL-Sl3Ms-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-fP7AE-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{segment-pattern-p}{NWlJ9ZL-Sl3Ms-1} (pattern)\nwindexdefn{\nwixident{segment-pattern-p}}{segment-pattern-p}{NWlJ9ZL-Sl3Ms-1}
  "Is this a segment matching pattern: ((?* var) . pat)"
  (and (consp pattern)
       (\nwlinkedidentc{starts-with}{NWlJ9ZL-26JY6E-1} (first pattern) '?*)))
\nwused{\\{NWlJ9ZL-fP7AE-1}}\nwidentdefs{\\{{\nwixident{segment-pattern-p}}{segment-pattern-p}}}\nwidentuses{\\{{\nwixident{starts-with}}{starts-with}}}\nwindexuse{\nwixident{starts-with}}{starts-with}{NWlJ9ZL-Sl3Ms-1}\nwendcode{}\nwbegindocs{141}\nwdocspar

\nwenddocs{}\nwbegincode{142}\sublabel{NWlJ9ZL-1JbiwF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1JbiwF-1}}}\moddef{variable-p~{\nwtagstyle{}\subpageref{NWlJ9ZL-1JbiwF-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-fP7AE-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{variable-p}{NWlJ9ZL-1JbiwF-1} (x)\nwindexdefn{\nwixident{variable-p}}{variable-p}{NWlJ9ZL-1JbiwF-1}
  "Is x a variable (a symbol beginning with '?')?"
  (and (symbolp x)
       (equal (char (symbol-name x) 0) #\\?)))
\nwused{\\{NWlJ9ZL-fP7AE-1}}\nwidentdefs{\\{{\nwixident{variable-p}}{variable-p}}}\nwendcode{}\nwbegindocs{143}\nwdocspar

\section{Constants}

\nwenddocs{}\nwbegincode{144}\sublabel{NWlJ9ZL-2EiFV2-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2EiFV2-1}}}\moddef{ELIZA: Constants~{\nwtagstyle{}\subpageref{NWlJ9ZL-2EiFV2-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3P1OfB-1}}\nwenddeflinemarkup
(defconstant \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1} nil\nwindexdefn{\nwixident{fail}}{fail}{NWlJ9ZL-2EiFV2-1}
  "Indicates \nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} failure")

(defconstant \nwlinkedidentc{no-bindings}{NWlJ9ZL-2EiFV2-1} '((t . t))\nwindexdefn{\nwixident{no-bindings}}{no-bindings}{NWlJ9ZL-2EiFV2-1}
  "Indicates \nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} success, with no variables.")
\nwused{\\{NWlJ9ZL-3P1OfB-1}}\nwidentdefs{\\{{\nwixident{fail}}{fail}}\\{{\nwixident{no-bindings}}{no-bindings}}}\nwidentuses{\\{{\nwixident{pat-match}}{pat-match}}}\nwindexuse{\nwixident{pat-match}}{pat-match}{NWlJ9ZL-2EiFV2-1}\nwendcode{}\nwbegindocs{145}\nwdocspar

\nwenddocs{}\nwbegincode{146}\sublabel{NWlJ9ZL-JLGGa-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-JLGGa-1}}}\moddef{ELIZA: Binding Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-JLGGa-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{get-binding}{NWlJ9ZL-JLGGa-1} (var bindings)\nwindexdefn{\nwixident{get-binding}}{get-binding}{NWlJ9ZL-JLGGa-1}
  "Find a (variable . value) pair in a binding list."
  (assoc var bindings))

(defun \nwlinkedidentc{binding-val}{NWlJ9ZL-JLGGa-1} (binding)\nwindexdefn{\nwixident{binding-val}}{binding-val}{NWlJ9ZL-JLGGa-1}
  "Get the value part of a single binding."
  (cdr binding))

(defun \nwlinkedidentc{lookup}{NWlJ9ZL-JLGGa-1} (var bindings)\nwindexdefn{\nwixident{lookup}}{lookup}{NWlJ9ZL-JLGGa-1}
  "Get the value part (for var) from a binding list."
  (\nwlinkedidentc{binding-val}{NWlJ9ZL-JLGGa-1} (\nwlinkedidentc{get-binding}{NWlJ9ZL-JLGGa-1} var bindings)))

(defun \nwlinkedidentc{extend-bindings}{NWlJ9ZL-JLGGa-1} (var val bindings)\nwindexdefn{\nwixident{extend-bindings}}{extend-bindings}{NWlJ9ZL-JLGGa-1}
  "Add a (var . value) pair to a binding list."
  (cons (cons var val)
        (if (eq bindings \nwlinkedidentc{no-bindings}{NWlJ9ZL-2EiFV2-1})
            nil
            bindings)))
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{binding-val}}{binding-val}}\\{{\nwixident{extend-bindings}}{extend-bindings}}\\{{\nwixident{get-binding}}{get-binding}}\\{{\nwixident{lookup}}{lookup}}}\nwidentuses{\\{{\nwixident{no-bindings}}{no-bindings}}}\nwindexuse{\nwixident{no-bindings}}{no-bindings}{NWlJ9ZL-JLGGa-1}\nwendcode{}\nwbegindocs{147}\nwdocspar

\section{Rules}

\nwenddocs{}\nwbegincode{148}\sublabel{NWlJ9ZL-3jvCTM-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3jvCTM-1}}}\moddef{ELIZA: Data Types~{\nwtagstyle{}\subpageref{NWlJ9ZL-3jvCTM-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3P1OfB-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{rule-pattern}{NWlJ9ZL-3jvCTM-1} (rule) (first rule))\nwindexdefn{\nwixident{rule-pattern}}{rule-pattern}{NWlJ9ZL-3jvCTM-1}
(defun \nwlinkedidentc{rule-responses}{NWlJ9ZL-3jvCTM-1} (rule) (rest rule))\nwindexdefn{\nwixident{rule-responses}}{rule-responses}{NWlJ9ZL-3jvCTM-1}
\nwused{\\{NWlJ9ZL-3P1OfB-1}}\nwidentdefs{\\{{\nwixident{rule-pattern}}{rule-pattern}}\\{{\nwixident{rule-responses}}{rule-responses}}}\nwendcode{}\nwbegindocs{149}\nwdocspar

\nwenddocs{}\nwbegincode{150}\sublabel{NWlJ9ZL-24Hem4-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-24Hem4-1}}}\moddef{ELIZA: Special Variables~{\nwtagstyle{}\subpageref{NWlJ9ZL-24Hem4-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3P1OfB-1}}\nwenddeflinemarkup
(defparameter *eliza-rules*
  '((((?* ?x) hello (?* ?y))
     (How do you do.  Please state your problem.))
    (((?* ?x) I want (?* ?y))
     (What would it mean if you got ?y)
     (Why do you want ?y) (Suppose you got ?y soon))
    (((?* ?x) if (?* ?y))
     (Do you really think its likely that ?y) (Do you wish that ?y)
     (What do you think about ?y) (Really-- if ?y))
    (((?* ?x) no (?* ?y))
     (Why not?) (You are being a bit negative)
     (Are you saying "NO" just to be negative?))
    (((?* ?x) I was (?* ?y))
     (Were you really?) (Perhaps I already knew you were ?y)
     (Why do you tell me you were ?y now?))
    (((?* ?x) I feel (?* ?y))
     (Do you often feel ?y ?))
    (((?* ?x) I felt (?* ?y))
     (What other feelings do you have?))))
\nwused{\\{NWlJ9ZL-3P1OfB-1}}\nwendcode{}\nwbegindocs{151}\nwdocspar

\section{{\sc Eliza} Proper}

\nwenddocs{}\nwbegincode{152}\sublabel{NWlJ9ZL-2T7eg6-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2T7eg6-1}}}\moddef{ELIZA: Top-Level Function~{\nwtagstyle{}\subpageref{NWlJ9ZL-2T7eg6-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3P1OfB-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{eliza}{NWlJ9ZL-2T7eg6-1} ()\nwindexdefn{\nwixident{eliza}}{eliza}{NWlJ9ZL-2T7eg6-1}
  "Respond to user input using pattern matching rules."
  (loop
    (print 'eliza>)
    (write (\nwlinkedidentc{flatten}{NWlJ9ZL-4UXBSo-1} (\nwlinkedidentc{use-eliza-rules}{NWlJ9ZL-2Wo01b-1} (read))) :pretty t)))
\nwused{\\{NWlJ9ZL-3P1OfB-1}}\nwidentdefs{\\{{\nwixident{eliza}}{eliza}}}\nwidentuses{\\{{\nwixident{flatten}}{flatten}}\\{{\nwixident{use-eliza-rules}}{use-eliza-rules}}}\nwindexuse{\nwixident{flatten}}{flatten}{NWlJ9ZL-2T7eg6-1}\nwindexuse{\nwixident{use-eliza-rules}}{use-eliza-rules}{NWlJ9ZL-2T7eg6-1}\nwendcode{}\nwbegindocs{153}\nwdocspar

\nwenddocs{}\nwbegincode{154}\sublabel{NWlJ9ZL-4MxtLd-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4MxtLd-1}}}\moddef{ELIZA: Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-4MxtLd-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-3P1OfB-1}}\nwenddeflinemarkup
\LA{}use-eliza-rules~{\nwtagstyle{}\subpageref{NWlJ9ZL-2Wo01b-1}}\RA{}

\LA{}switch-viewpoint~{\nwtagstyle{}\subpageref{NWlJ9ZL-1ms3Or-1}}\RA{}

\LA{}ELIZA: Pattern Matching~{\nwtagstyle{}\subpageref{NWlJ9ZL-fP7AE-1}}\RA{}

\LA{}ELIZA: Binding Functions~{\nwtagstyle{}\subpageref{NWlJ9ZL-JLGGa-1}}\RA{}

\LA{}flatten~{\nwtagstyle{}\subpageref{NWlJ9ZL-4UXBSo-1}}\RA{}

\LA{}random-elt~{\nwtagstyle{}\subpageref{NWlJ9ZL-2bmzlG-1}}\RA{}

\LA{}mappend~{\nwtagstyle{}\subpageref{NWlJ9ZL-4BOcTg-1}}\RA{}

\LA{}Is the argument a list that starts with a given atom?~{\nwtagstyle{}\subpageref{NWlJ9ZL-26JY6E-1}}\RA{}
\nwused{\\{NWlJ9ZL-3P1OfB-1}}\nwendcode{}\nwbegindocs{155}\nwdocspar

\nwenddocs{}\nwbegincode{156}\sublabel{NWlJ9ZL-2Wo01b-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2Wo01b-1}}}\moddef{use-eliza-rules~{\nwtagstyle{}\subpageref{NWlJ9ZL-2Wo01b-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{use-eliza-rules}{NWlJ9ZL-2Wo01b-1} (input)\nwindexdefn{\nwixident{use-eliza-rules}}{use-eliza-rules}{NWlJ9ZL-2Wo01b-1}
  "Find some rule with which to transform the input."
  (some #'(lambda (rule)
            (let ((result (\nwlinkedidentc{pat-match}{NWlJ9ZL-3nmfAz-1} (\nwlinkedidentc{rule-pattern}{NWlJ9ZL-3jvCTM-1} rule) input)))
              (unless (eq result \nwlinkedidentc{fail}{NWlJ9ZL-2EiFV2-1})
                (sublis (\nwlinkedidentc{switch-viewpoint}{NWlJ9ZL-1ms3Or-1} result)
                        (\nwlinkedidentc{random-elt}{NWlJ9ZL-2bmzlG-1} (\nwlinkedidentc{rule-responses}{NWlJ9ZL-3jvCTM-1} rule))))))
        *eliza-rules*))
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{use-eliza-rules}}{use-eliza-rules}}}\nwidentuses{\\{{\nwixident{fail}}{fail}}\\{{\nwixident{pat-match}}{pat-match}}\\{{\nwixident{random-elt}}{random-elt}}\\{{\nwixident{rule-pattern}}{rule-pattern}}\\{{\nwixident{rule-responses}}{rule-responses}}\\{{\nwixident{switch-viewpoint}}{switch-viewpoint}}}\nwindexuse{\nwixident{fail}}{fail}{NWlJ9ZL-2Wo01b-1}\nwindexuse{\nwixident{pat-match}}{pat-match}{NWlJ9ZL-2Wo01b-1}\nwindexuse{\nwixident{random-elt}}{random-elt}{NWlJ9ZL-2Wo01b-1}\nwindexuse{\nwixident{rule-pattern}}{rule-pattern}{NWlJ9ZL-2Wo01b-1}\nwindexuse{\nwixident{rule-responses}}{rule-responses}{NWlJ9ZL-2Wo01b-1}\nwindexuse{\nwixident{switch-viewpoint}}{switch-viewpoint}{NWlJ9ZL-2Wo01b-1}\nwendcode{}\nwbegindocs{157}\nwdocspar

\nwenddocs{}\nwbegincode{158}\sublabel{NWlJ9ZL-1ms3Or-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-1ms3Or-1}}}\moddef{switch-viewpoint~{\nwtagstyle{}\subpageref{NWlJ9ZL-1ms3Or-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{switch-viewpoint}{NWlJ9ZL-1ms3Or-1} (words)\nwindexdefn{\nwixident{switch-viewpoint}}{switch-viewpoint}{NWlJ9ZL-1ms3Or-1}
  "Change I to you and vice versa, and so on."
  (sublis '((I . you) (you . I) (me . you) (am . are))
          words))
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{switch-viewpoint}}{switch-viewpoint}}}\nwendcode{}\nwbegindocs{159}\nwdocspar

\nwenddocs{}\nwbegincode{160}\sublabel{NWlJ9ZL-4UXBSo-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-4UXBSo-1}}}\moddef{flatten~{\nwtagstyle{}\subpageref{NWlJ9ZL-4UXBSo-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-4MxtLd-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{flatten}{NWlJ9ZL-4UXBSo-1} (the-list)\nwindexdefn{\nwixident{flatten}}{flatten}{NWlJ9ZL-4UXBSo-1}
  "Append together elements (or lists) in the list."
  (\nwlinkedidentc{mappend}{NWlJ9ZL-4BOcTg-1} #'\nwlinkedidentc{mklist}{NWlJ9ZL-4UXBSo-1} the-list))

(defun \nwlinkedidentc{mklist}{NWlJ9ZL-4UXBSo-1} (x)\nwindexdefn{\nwixident{mklist}}{mklist}{NWlJ9ZL-4UXBSo-1}
  "Return x if it is a list, otherwise (x)."
  (if (listp x)
      x
      (list x)))
\nwused{\\{NWlJ9ZL-4MxtLd-1}}\nwidentdefs{\\{{\nwixident{flatten}}{flatten}}\\{{\nwixident{mklist}}{mklist}}}\nwidentuses{\\{{\nwixident{mappend}}{mappend}}}\nwindexuse{\nwixident{mappend}}{mappend}{NWlJ9ZL-4UXBSo-1}\nwendcode{}\nwbegindocs{161}\nwdocspar

\chapter{Build Software Tools}

\section{An Interactive Interpreter Tool}

\begin{minted}[]{lisp}
(defun program ()
  (loop
    (print prompt)
    (print (transform (read)))))
\end{minted}

\nwenddocs{}\nwbegincode{162}\sublabel{NWlJ9ZL-37Um9m-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-37Um9m-1}}}\moddef{interactive-interpreter~{\nwtagstyle{}\subpageref{NWlJ9ZL-37Um9m-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-rFUuu-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{interactive-interpreter}{NWlJ9ZL-37Um9m-1} (prompt transformer)\nwindexdefn{\nwixident{interactive-interpreter}}{interactive-interpreter}{NWlJ9ZL-37Um9m-1}
  "(`prompt' for and) read an expression, `transform' it and print the result."
  (loop
    (handler-case
        (progn
          (if (stringp prompt)
              (print prompt)
              (funcall prompt))
          (print (funcall transformer (read))))
      (error (condition)
        (format t "~&;; Error ~a ignored. Back to top level."
                condition)))))

\LA{}prompt-generator~{\nwtagstyle{}\subpageref{NWlJ9ZL-2r7hDu-1}}\RA{}
\nwused{\\{NWlJ9ZL-rFUuu-1}}\nwidentdefs{\\{{\nwixident{interactive-interpreter}}{interactive-interpreter}}}\nwendcode{}\nwbegindocs{163}\nwdocspar

\nwenddocs{}\nwbegincode{164}\sublabel{NWlJ9ZL-2r7hDu-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-2r7hDu-1}}}\moddef{prompt-generator~{\nwtagstyle{}\subpageref{NWlJ9ZL-2r7hDu-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NWlJ9ZL-37Um9m-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{prompt-generator}{NWlJ9ZL-2r7hDu-1} (&optional (num 0) (ctl-string "[~d] "))\nwindexdefn{\nwixident{prompt-generator}}{prompt-generator}{NWlJ9ZL-2r7hDu-1}
  "Return a function that prints prompts like [1], [2], etc."
  #'(lambda () (format t ctl-string (incf num))))
\nwused{\\{NWlJ9ZL-37Um9m-1}}\nwidentdefs{\\{{\nwixident{prompt-generator}}{prompt-generator}}}\nwendcode{}\nwbegindocs{165}\nwdocspar

\section{Package}

\nwenddocs{}\nwbegincode{166}\sublabel{NWlJ9ZL-rFUuu-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-rFUuu-1}}}\moddef{src/tools.lisp~{\nwtagstyle{}\subpageref{NWlJ9ZL-rFUuu-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(in-package #:paip)
(defpackage #:paip.tools
  (:\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} #:cl #:lisp-unit))
(in-package #:paip.tools)

\LA{}interactive-interpreter~{\nwtagstyle{}\subpageref{NWlJ9ZL-37Um9m-1}}\RA{}
\nwnotused{src/tools.lisp}\nwidentuses{\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-rFUuu-1}\nwendcode{}\nwbegindocs{167}\nwdocspar

\chapter{Package}

\nwenddocs{}\nwbegincode{168}\sublabel{NWlJ9ZL-34miW3-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-34miW3-1}}}\moddef{paip.asd~{\nwtagstyle{}\subpageref{NWlJ9ZL-34miW3-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
;;;; paip.asd

(asdf:defsystem #:paip
  :description "Paradigms of Artificial Intelligence Programming exercises"
  :author "Eric Bailey <eric@ericb.me>"
  ;; TODO :license "Specify license here"
  :depends-on (#:lisp-unit)
  :serial t
  :components ((:module "src"
                :serial t
                :components
                ((:file "intro")
                 (:file "gps")
                 (:file "\nwlinkedidentc{eliza}{NWlJ9ZL-2T7eg6-1}")
                 (:file "tools")))))

(defpackage #:paip
  (:\nwlinkedidentc{use}{NWlJ9ZL-3V5be-1} #:cl))
(in-package #:paip)
\nwnotused{paip.asd}\nwidentuses{\\{{\nwixident{eliza}}{eliza}}\\{{\nwixident{use}}{use}}}\nwindexuse{\nwixident{eliza}}{eliza}{NWlJ9ZL-34miW3-1}\nwindexuse{\nwixident{use}}{use}{NWlJ9ZL-34miW3-1}\nwendcode{}\nwbegindocs{169}\nwdocspar

\chapter{Test Runner}

\nwenddocs{}\nwbegincode{170}\sublabel{NWlJ9ZL-3QIFQJ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-3QIFQJ-1}}}\moddef{bin/runtests~{\nwtagstyle{}\subpageref{NWlJ9ZL-3QIFQJ-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
#! /usr/bin/env nix-shell
#! nix-shell -i sh -p sbcl

# N.B. quicklisp must be installed and configured.

sbcl --noinform --non-interactive \\
     --userinit init.lisp \\
     --eval "(in-package :paip.$1)" \\
     --eval "(let* ((results  (lisp-unit:run-tests :all :paip.$1))
                    (failures (lisp-unit:failed-tests results))
                    (status   (if (null failures) 0 1)))
               (lisp-unit:print-failures results)
               (sb-posix:exit status))"
\nwnotused{bin/runtests}\nwendcode{}\nwbegindocs{171}\nwdocspar

\nwenddocs{}\nwbegincode{172}\sublabel{NWlJ9ZL-40xICN-1}\nwmargintag{{\nwtagstyle{}\subpageref{NWlJ9ZL-40xICN-1}}}\moddef{init.lisp~{\nwtagstyle{}\subpageref{NWlJ9ZL-40xICN-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
#-quicklisp
(let ((quicklisp-init (merge-pathnames "quicklisp/setup.lisp"
                                       (user-homedir-pathname))))
  (when (probe-file quicklisp-init)
    (load quicklisp-init)))

(push (concatenate 'string (sb-posix:getcwd) "/")
      asdf:*central-registry*)

(asdf:load-system :paip)
\nwnotused{init.lisp}\nwendcode{}

\nwixlogsorted{c}{{A list of available operators}{NWlJ9ZL-1JBQVW-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-1JBQVW-1}}}%
\nwixlogsorted{c}{{abstract first-name}{NWlJ9ZL-1xnn0Z-1}{\nwixd{NWlJ9ZL-1xnn0Z-1}}}%
\nwixlogsorted{c}{{Achieve all goals}{NWlJ9ZL-23MH3b-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-23MH3b-1}}}%
\nwixlogsorted{c}{{Achieve an individual goal}{NWlJ9ZL-1Tx3Kh-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-1Tx3Kh-1}}}%
\nwixlogsorted{c}{{An operation with preconds, add-list and del-list}{NWlJ9ZL-2hGwYk-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-2hGwYk-1}}}%
\nwixlogsorted{c}{{Apply operator to current state}{NWlJ9ZL-3nt6zV-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-3nt6zV-1}}}%
\nwixlogsorted{c}{{Auxiliary Functions}{NWlJ9ZL-QzWjb-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-QzWjb-1}}}%
\nwixlogsorted{c}{{bin/runtests}{NWlJ9ZL-3QIFQJ-1}{\nwixd{NWlJ9ZL-3QIFQJ-1}}}%
\nwixlogsorted{c}{{Blocks World Tests}{NWlJ9ZL-8artJ-1}{\nwixu{NWlJ9ZL-1t2bMc-1}\nwixd{NWlJ9ZL-8artJ-1}}}%
\nwixlogsorted{c}{{Blocks: The Sussman Anomaly}{NWlJ9ZL-2FEfPq-1}{\nwixu{NWlJ9ZL-8artJ-1}\nwixd{NWlJ9ZL-2FEfPq-1}}}%
\nwixlogsorted{c}{{Call \code{}pat-match\edoc{} recursively}{NWlJ9ZL-4cCTse-1}{\nwixu{NWlJ9ZL-3nmfAz-1}\nwixd{NWlJ9ZL-4cCTse-1}}}%
\nwixlogsorted{c}{{Convert an operator to use the executing convention}{NWlJ9ZL-3MvEWn-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-3MvEWn-1}}}%
\nwixlogsorted{c}{{Convert existing operators}{NWlJ9ZL-yooUt-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-yooUt-1}}}%
\nwixlogsorted{c}{{Create an operator}{NWlJ9ZL-aGgy4-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-aGgy4-1}}}%
\nwixlogsorted{c}{{Debugging usage}{NWlJ9ZL-3AihUJ-1}{\nwixd{NWlJ9ZL-3AihUJ-1}}}%
\nwixlogsorted{c}{{Decide if an operator is appropriate for a goal}{NWlJ9ZL-ocPeo-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-ocPeo-1}}}%
\nwixlogsorted{c}{{Drive son to school}{NWlJ9ZL-31LYLP-1}{\nwixd{NWlJ9ZL-31LYLP-1}\nwixu{NWlJ9ZL-4Zg5N4-1}}}%
\nwixlogsorted{c}{{ELIZA: Binding Functions}{NWlJ9ZL-JLGGa-1}{\nwixd{NWlJ9ZL-JLGGa-1}\nwixu{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{ELIZA: Constants}{NWlJ9ZL-2EiFV2-1}{\nwixu{NWlJ9ZL-3P1OfB-1}\nwixd{NWlJ9ZL-2EiFV2-1}}}%
\nwixlogsorted{c}{{ELIZA: Data Types}{NWlJ9ZL-3jvCTM-1}{\nwixu{NWlJ9ZL-3P1OfB-1}\nwixd{NWlJ9ZL-3jvCTM-1}}}%
\nwixlogsorted{c}{{ELIZA: Functions}{NWlJ9ZL-4MxtLd-1}{\nwixu{NWlJ9ZL-3P1OfB-1}\nwixd{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{ELIZA: Pattern Matching}{NWlJ9ZL-fP7AE-1}{\nwixd{NWlJ9ZL-fP7AE-1}\nwixu{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{ELIZA: Special Variables}{NWlJ9ZL-24Hem4-1}{\nwixu{NWlJ9ZL-3P1OfB-1}\nwixd{NWlJ9ZL-24Hem4-1}}}%
\nwixlogsorted{c}{{ELIZA: Top-Level Function}{NWlJ9ZL-2T7eg6-1}{\nwixu{NWlJ9ZL-3P1OfB-1}\nwixd{NWlJ9ZL-2T7eg6-1}}}%
\nwixlogsorted{c}{{else return the first element of the name}{NWlJ9ZL-16R8JG-1}{\nwixu{NWlJ9ZL-1xnn0Z-1}\nwixd{NWlJ9ZL-16R8JG-1}}}%
\nwixlogsorted{c}{{else return the last element of the name}{NWlJ9ZL-2NIVBh-1}{\nwixu{NWlJ9ZL-4Zlwoj-1}\nwixd{NWlJ9ZL-2NIVBh-1}}}%
\nwixlogsorted{c}{{Exercise 1.1}{NWlJ9ZL-4Wuo2N-1}{\nwixu{NWlJ9ZL-3M2WD4-1}\nwixd{NWlJ9ZL-4Wuo2N-1}}}%
\nwixlogsorted{c}{{Exercise 1.1 tests}{NWlJ9ZL-29KvuZ-1}{\nwixu{NWlJ9ZL-4Wuo2N-1}\nwixd{NWlJ9ZL-29KvuZ-1}}}%
\nwixlogsorted{c}{{Exercise 1.2}{NWlJ9ZL-2DHmDj-1}{\nwixu{NWlJ9ZL-3M2WD4-1}\nwixd{NWlJ9ZL-2DHmDj-1}}}%
\nwixlogsorted{c}{{Exercise 1.2 tests}{NWlJ9ZL-Nfd08-1}{\nwixu{NWlJ9ZL-2DHmDj-1}\nwixd{NWlJ9ZL-Nfd08-1}}}%
\nwixlogsorted{c}{{Exercise 1.3}{NWlJ9ZL-2b8599-1}{\nwixu{NWlJ9ZL-3M2WD4-1}\nwixd{NWlJ9ZL-2b8599-1}}}%
\nwixlogsorted{c}{{Fail if the binding list is \lsp{fail}}{NWlJ9ZL-1NgPsX-1}{\nwixu{NWlJ9ZL-3nmfAz-1}\nwixd{NWlJ9ZL-1NgPsX-1}}}%
\nwixlogsorted{c}{{find-all}{NWlJ9ZL-3sUrxR-1}{\nwixd{NWlJ9ZL-3sUrxR-1}\nwixu{NWlJ9ZL-wDl5T-1}}}%
\nwixlogsorted{c}{{flatten}{NWlJ9ZL-4UXBSo-1}{\nwixu{NWlJ9ZL-4MxtLd-1}\nwixd{NWlJ9ZL-4UXBSo-1}}}%
\nwixlogsorted{c}{{function first-name(name):}{NWlJ9ZL-4ONS4K-1}{\nwixu{NWlJ9ZL-1xnn0Z-1}\nwixd{NWlJ9ZL-4ONS4K-1}}}%
\nwixlogsorted{c}{{GPS Tests}{NWlJ9ZL-1ahSlC-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-1ahSlC-1}}}%
\nwixlogsorted{c}{{If \lsp{pattern} equals \lsp{input}, return \lsp{bindings}}{NWlJ9ZL-3hXqLN-1}{\nwixu{NWlJ9ZL-3nmfAz-1}\nwixd{NWlJ9ZL-3hXqLN-1}}}%
\nwixlogsorted{c}{{if exp is an atom there is only one}{NWlJ9ZL-20ij8Y-1}{\nwixu{NWlJ9ZL-2b8599-1}\nwixd{NWlJ9ZL-20ij8Y-1}}}%
\nwixlogsorted{c}{{if exp is nil there are no atoms}{NWlJ9ZL-2dHnrc-1}{\nwixu{NWlJ9ZL-2b8599-1}\nwixd{NWlJ9ZL-2dHnrc-1}}}%
\nwixlogsorted{c}{{if n is even return x to the power of n over two, squared}{NWlJ9ZL-3Slm34-1}{\nwixu{NWlJ9ZL-3kZCB2-1}\nwixd{NWlJ9ZL-3Slm34-1}}}%
\nwixlogsorted{c}{{if n is zero return 1}{NWlJ9ZL-2y88rI-1}{\nwixu{NWlJ9ZL-3kZCB2-1}\nwixd{NWlJ9ZL-2y88rI-1}}}%
\nwixlogsorted{c}{{if the first element of name is a title}{NWlJ9ZL-Ix42V-1}{\nwixu{NWlJ9ZL-1xnn0Z-1}\nwixd{NWlJ9ZL-Ix42V-1}}}%
\nwixlogsorted{c}{{init.lisp}{NWlJ9ZL-40xICN-1}{\nwixd{NWlJ9ZL-40xICN-1}}}%
\nwixlogsorted{c}{{interactive-interpreter}{NWlJ9ZL-37Um9m-1}{\nwixd{NWlJ9ZL-37Um9m-1}\nwixu{NWlJ9ZL-rFUuu-1}}}%
\nwixlogsorted{c}{{Is a condition an executing form?}{NWlJ9ZL-3ZribA-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-3ZribA-1}}}%
\nwixlogsorted{c}{{Is the argument a list that starts with a given atom?}{NWlJ9ZL-26JY6E-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-26JY6E-1}\nwixu{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{Is x an action?}{NWlJ9ZL-lDJbR-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-lDJbR-1}}}%
\nwixlogsorted{c}{{last-name}{NWlJ9ZL-4Zlwoj-1}{\nwixu{NWlJ9ZL-4Wuo2N-1}\nwixd{NWlJ9ZL-4Zlwoj-1}}}%
\nwixlogsorted{c}{{mappend}{NWlJ9ZL-4BOcTg-1}{\nwixd{NWlJ9ZL-4BOcTg-1}\nwixu{NWlJ9ZL-wDl5T-1}\nwixu{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{Match a segment}{NWlJ9ZL-GZe9f-1}{\nwixu{NWlJ9ZL-3nmfAz-1}\nwixd{NWlJ9ZL-GZe9f-1}}}%
\nwixlogsorted{c}{{Match a variable}{NWlJ9ZL-1c11Uf-1}{\nwixu{NWlJ9ZL-3nmfAz-1}\nwixd{NWlJ9ZL-1c11Uf-1}}}%
\nwixlogsorted{c}{{match-variable}{NWlJ9ZL-1BlMBi-1}{\nwixu{NWlJ9ZL-fP7AE-1}\nwixd{NWlJ9ZL-1BlMBi-1}}}%
\nwixlogsorted{c}{{Maze Tests}{NWlJ9ZL-v1OUw-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-v1OUw-1}}}%
\nwixlogsorted{c}{{Monkey and Bananas Example}{NWlJ9ZL-GNLBM-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-GNLBM-1}}}%
\nwixlogsorted{c}{{Morton Downey, Jr}{NWlJ9ZL-189ElO-1}{\nwixu{NWlJ9ZL-29KvuZ-1}\nwixd{NWlJ9ZL-189ElO-1}}}%
\nwixlogsorted{c}{{Nursery School Example}{NWlJ9ZL-4Zg5N4-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-4Zg5N4-1}}}%
\nwixlogsorted{c}{{otherwise add the count of the atoms in the first and rest of exp}{NWlJ9ZL-44AOMF-1}{\nwixu{NWlJ9ZL-2b8599-1}\nwixd{NWlJ9ZL-44AOMF-1}}}%
\nwixlogsorted{c}{{otherwise return x times x to the power of n minus one}{NWlJ9ZL-1kE0RF-1}{\nwixu{NWlJ9ZL-3kZCB2-1}\nwixd{NWlJ9ZL-1kE0RF-1}}}%
\nwixlogsorted{c}{{paip.asd}{NWlJ9ZL-34miW3-1}{\nwixd{NWlJ9ZL-34miW3-1}}}%
\nwixlogsorted{c}{{pat-match}{NWlJ9ZL-3nmfAz-1}{\nwixu{NWlJ9ZL-fP7AE-1}\nwixd{NWlJ9ZL-3nmfAz-1}}}%
\nwixlogsorted{c}{{permutations}{NWlJ9ZL-4ArfbM-1}{\nwixd{NWlJ9ZL-4ArfbM-1}}}%
\nwixlogsorted{c}{{power}{NWlJ9ZL-3kZCB2-1}{\nwixu{NWlJ9ZL-2DHmDj-1}\nwixd{NWlJ9ZL-3kZCB2-1}}}%
\nwixlogsorted{c}{{Print debugging information}{NWlJ9ZL-3LP9Za-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-3LP9Za-1}}}%
\nwixlogsorted{c}{{prompt-generator}{NWlJ9ZL-2r7hDu-1}{\nwixu{NWlJ9ZL-37Um9m-1}\nwixd{NWlJ9ZL-2r7hDu-1}}}%
\nwixlogsorted{c}{{random-elt}{NWlJ9ZL-2bmzlG-1}{\nwixd{NWlJ9ZL-2bmzlG-1}\nwixu{NWlJ9ZL-4MxtLd-1}}}%
\nwixlogsorted{c}{{Rex Morgan MD}{NWlJ9ZL-1iWMbJ-1}{\nwixu{NWlJ9ZL-29KvuZ-1}\nwixd{NWlJ9ZL-1iWMbJ-1}}}%
\nwixlogsorted{c}{{segment-match}{NWlJ9ZL-1VV14C-1}{\nwixu{NWlJ9ZL-fP7AE-1}\nwixd{NWlJ9ZL-1VV14C-1}}}%
\nwixlogsorted{c}{{segment-pattern-p}{NWlJ9ZL-Sl3Ms-1}{\nwixu{NWlJ9ZL-fP7AE-1}\nwixd{NWlJ9ZL-Sl3Ms-1}}}%
\nwixlogsorted{c}{{Solve a goal from a state using a list of operators}{NWlJ9ZL-30p2tX-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-30p2tX-1}}}%
\nwixlogsorted{c}{{square}{NWlJ9ZL-3NPSQP-1}{\nwixu{NWlJ9ZL-2DHmDj-1}\nwixd{NWlJ9ZL-3NPSQP-1}}}%
\nwixlogsorted{c}{{src/eliza.lisp}{NWlJ9ZL-3P1OfB-1}{\nwixd{NWlJ9ZL-3P1OfB-1}}}%
\nwixlogsorted{c}{{src/gps.lisp}{NWlJ9ZL-wDl5T-1}{\nwixd{NWlJ9ZL-wDl5T-1}}}%
\nwixlogsorted{c}{{src/intro.lisp}{NWlJ9ZL-3M2WD4-1}{\nwixd{NWlJ9ZL-3M2WD4-1}}}%
\nwixlogsorted{c}{{src/tools.lisp}{NWlJ9ZL-rFUuu-1}{\nwixd{NWlJ9ZL-rFUuu-1}}}%
\nwixlogsorted{c}{{suffixes}{NWlJ9ZL-33GIZY-1}{\nwixu{NWlJ9ZL-4Wuo2N-1}\nwixd{NWlJ9ZL-33GIZY-1}}}%
\nwixlogsorted{c}{{switch-viewpoint}{NWlJ9ZL-1ms3Or-1}{\nwixu{NWlJ9ZL-4MxtLd-1}\nwixd{NWlJ9ZL-1ms3Or-1}}}%
\nwixlogsorted{c}{{Test if an element is equal to a member of a list}{NWlJ9ZL-1aljzn-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-1aljzn-1}}}%
\nwixlogsorted{c}{{The Blocks World Domain}{NWlJ9ZL-1t2bMc-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-1t2bMc-1}}}%
\nwixlogsorted{c}{{the last element of a name is a suffix}{NWlJ9ZL-2t3lxE-1}{\nwixu{NWlJ9ZL-4Zlwoj-1}\nwixd{NWlJ9ZL-2t3lxE-1}}}%
\nwixlogsorted{c}{{The Maze Searching Domain}{NWlJ9ZL-2DSCmQ-1}{\nwixu{NWlJ9ZL-wDl5T-1}\nwixd{NWlJ9ZL-2DSCmQ-1}}}%
\nwixlogsorted{c}{{then return the \code{}last-name\edoc{} of all but the last element of the name}{NWlJ9ZL-3W6gHs-1}{\nwixu{NWlJ9ZL-4Zlwoj-1}\nwixd{NWlJ9ZL-3W6gHs-1}}}%
\nwixlogsorted{c}{{then return the first-name of the rest of the name}{NWlJ9ZL-2nVNHx-1}{\nwixu{NWlJ9ZL-1xnn0Z-1}\nwixd{NWlJ9ZL-2nVNHx-1}}}%
\nwixlogsorted{c}{{titles}{NWlJ9ZL-BpWdi-1}{\nwixd{NWlJ9ZL-BpWdi-1}\nwixu{NWlJ9ZL-3M2WD4-1}}}%
\nwixlogsorted{c}{{Use a list of of operators}{NWlJ9ZL-3V5be-1}{\nwixu{NWlJ9ZL-QzWjb-1}\nwixd{NWlJ9ZL-3V5be-1}}}%
\nwixlogsorted{c}{{use-eliza-rules}{NWlJ9ZL-2Wo01b-1}{\nwixu{NWlJ9ZL-4MxtLd-1}\nwixd{NWlJ9ZL-2Wo01b-1}}}%
\nwixlogsorted{c}{{variable-p}{NWlJ9ZL-1JbiwF-1}{\nwixu{NWlJ9ZL-fP7AE-1}\nwixd{NWlJ9ZL-1JbiwF-1}}}%
\nwixlogsorted{i}{{\nwixident{*dbg-ids*}}{*dbg-ids*}}%
\nwixlogsorted{i}{{\nwixident{*ops*}}{*ops*}}%
\nwixlogsorted{i}{{\nwixident{*school-ops*}}{*school-ops*}}%
\nwixlogsorted{i}{{\nwixident{*suffixes*}}{*suffixes*}}%
\nwixlogsorted{i}{{\nwixident{*titles*}}{*titles*}}%
\nwixlogsorted{i}{{\nwixident{achieve}}{achieve}}%
\nwixlogsorted{i}{{\nwixident{achieve-all}}{achieve-all}}%
\nwixlogsorted{i}{{\nwixident{achieve-each}}{achieve-each}}%
\nwixlogsorted{i}{{\nwixident{action-p}}{action-p}}%
\nwixlogsorted{i}{{\nwixident{apply-op}}{apply-op}}%
\nwixlogsorted{i}{{\nwixident{appropriate-ops}}{appropriate-ops}}%
\nwixlogsorted{i}{{\nwixident{appropriate-p}}{appropriate-p}}%
\nwixlogsorted{i}{{\nwixident{binding-val}}{binding-val}}%
\nwixlogsorted{i}{{\nwixident{convert-op}}{convert-op}}%
\nwixlogsorted{i}{{\nwixident{count-atoms}}{count-atoms}}%
\nwixlogsorted{i}{{\nwixident{dbg}}{dbg}}%
\nwixlogsorted{i}{{\nwixident{dbg-indent}}{dbg-indent}}%
\nwixlogsorted{i}{{\nwixident{debug}}{debug}}%
\nwixlogsorted{i}{{\nwixident{destination}}{destination}}%
\nwixlogsorted{i}{{\nwixident{eliza}}{eliza}}%
\nwixlogsorted{i}{{\nwixident{executing-p}}{executing-p}}%
\nwixlogsorted{i}{{\nwixident{extend-bindings}}{extend-bindings}}%
\nwixlogsorted{i}{{\nwixident{fail}}{fail}}%
\nwixlogsorted{i}{{\nwixident{find-all}}{find-all}}%
\nwixlogsorted{i}{{\nwixident{find-path}}{find-path}}%
\nwixlogsorted{i}{{\nwixident{flatten}}{flatten}}%
\nwixlogsorted{i}{{\nwixident{get-binding}}{get-binding}}%
\nwixlogsorted{i}{{\nwixident{GPS}}{GPS}}%
\nwixlogsorted{i}{{\nwixident{interactive-interpreter}}{interactive-interpreter}}%
\nwixlogsorted{i}{{\nwixident{last-name}}{last-name}}%
\nwixlogsorted{i}{{\nwixident{lookup}}{lookup}}%
\nwixlogsorted{i}{{\nwixident{make-block-ops}}{make-block-ops}}%
\nwixlogsorted{i}{{\nwixident{make-maze-op}}{make-maze-op}}%
\nwixlogsorted{i}{{\nwixident{make-maze-ops}}{make-maze-ops}}%
\nwixlogsorted{i}{{\nwixident{mappend}}{mappend}}%
\nwixlogsorted{i}{{\nwixident{match-variable}}{match-variable}}%
\nwixlogsorted{i}{{\nwixident{member-equal}}{member-equal}}%
\nwixlogsorted{i}{{\nwixident{mklist}}{mklist}}%
\nwixlogsorted{i}{{\nwixident{move-ons}}{move-ons}}%
\nwixlogsorted{i}{{\nwixident{move-op}}{move-op}}%
\nwixlogsorted{i}{{\nwixident{no-bindings}}{no-bindings}}%
\nwixlogsorted{i}{{\nwixident{op}}{op}}%
\nwixlogsorted{i}{{\nwixident{orderings}}{orderings}}%
\nwixlogsorted{i}{{\nwixident{pat-match}}{pat-match}}%
\nwixlogsorted{i}{{\nwixident{permutations}}{permutations}}%
\nwixlogsorted{i}{{\nwixident{power}}{power}}%
\nwixlogsorted{i}{{\nwixident{prompt-generator}}{prompt-generator}}%
\nwixlogsorted{i}{{\nwixident{random-elt}}{random-elt}}%
\nwixlogsorted{i}{{\nwixident{rule-pattern}}{rule-pattern}}%
\nwixlogsorted{i}{{\nwixident{rule-responses}}{rule-responses}}%
\nwixlogsorted{i}{{\nwixident{segment-match}}{segment-match}}%
\nwixlogsorted{i}{{\nwixident{segment-pattern-p}}{segment-pattern-p}}%
\nwixlogsorted{i}{{\nwixident{square}}{square}}%
\nwixlogsorted{i}{{\nwixident{starts-with}}{starts-with}}%
\nwixlogsorted{i}{{\nwixident{switch-viewpoint}}{switch-viewpoint}}%
\nwixlogsorted{i}{{\nwixident{undebug}}{undebug}}%
\nwixlogsorted{i}{{\nwixident{use}}{use}}%
\nwixlogsorted{i}{{\nwixident{use-eliza-rules}}{use-eliza-rules}}%
\nwixlogsorted{i}{{\nwixident{variable-p}}{variable-p}}%
\nwbegindocs{173}\nwdocspar

\chapter{Chunks}
\nowebchunks

\chapter{Index}
\nowebindex

\bibliography{paip}
\bibliographystyle{plainnat}

\end{document}
\nwenddocs{}
